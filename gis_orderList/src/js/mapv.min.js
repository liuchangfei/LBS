(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?a(exports):typeof define==="function"&&define.amd?define(["exports"],a):(a((b.mapv=b.mapv||{})))}(this,(function(V){var C="2.0.13";var ap=function(a8){a8&&a8.clearRect&&a8.clearRect(0,0,a8.canvas.width,a8.canvas.height)};var aC=function(a9){var a8=window.devicePixelRatio;a9.canvas.width=a9.canvas.width*a8;a9.canvas.height=a9.canvas.height*a8;a9.canvas.style.width=a9.canvas.width/a8+"px";a9.canvas.style.height=a9.canvas.height/a8+"px";a9.scale(a8,a8)};function S(){this._subscribers={}}S.prototype.on=function(a8,ba){var a9=this._subscribers[a8];if(!a9){a9=[];this._subscribers[a8]=a9}a9.push({callback:ba})};S.prototype.off=function(a9,bb){var ba=this._subscribers[a9];if(ba){for(var a8=0;a8<ba.length;a8++){if(ba[a8].callback==bb){ba.splice(a8,1);a8--}}}};S.prototype._trigger=function(bb,be,bd){if(bb=="*"){throw new Error("Cannot trigger event *")}var bc=[];if(bb in this._subscribers){bc=bc.concat(this._subscribers[bb])}if("*" in this._subscribers){bc=bc.concat(this._subscribers["*"])}for(var a9=0,a8=bc.length;a9<a8;a9++){var ba=bc[a9];if(ba.callback){ba.callback(bb,be,bd||null)}}};var q=function(a8,a9){if(!(a8 instanceof a9)){throw new TypeError("Cannot call a class as a function")}};var a2=function(){function a8(bc,ba){for(var a9=0;a9<ba.length;a9++){var bb=ba[a9];bb.enumerable=bb.enumerable||false;bb.configurable=true;if("value" in bb){bb.writable=true}Object.defineProperty(bc,bb.key,bb)}}return function(bb,a9,ba){if(a9){a8(bb.prototype,a9)}if(ba){a8(bb,ba)}return bb}}();var aJ=function aJ(a9,bc,bb){if(a9===null){a9=Function.prototype}var bd=Object.getOwnPropertyDescriptor(a9,bc);if(bd===undefined){var ba=Object.getPrototypeOf(a9);if(ba===null){return undefined}else{return aJ(ba,bc,bb)}}else{if("value" in bd){return bd.value}else{var a8=bd.get;if(a8===undefined){return undefined}return a8.call(bb)}}};var aK=function(a9,a8){if(typeof a8!=="function"&&a8!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof a8)}a9.prototype=Object.create(a8&&a8.prototype,{constructor:{value:a9,enumerable:false,writable:true,configurable:true}});if(a8){Object.setPrototypeOf?Object.setPrototypeOf(a9,a8):a9.__proto__=a8}};var a3=function(a8,a9){if(!a8){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a9&&(typeof a9==="object"||typeof a9==="function")?a9:a8};function i(a9,a8){S.bind(this)();this._options=a8||{};this._data=[];if(a9){this.add(a9)}}i.prototype=S.prototype;i.prototype.add=function(ba,bc){if(Array.isArray(ba)){for(var a9=0,a8=ba.length;a9<a8;a9++){if(ba[a9].time&&ba[a9].time.length==14&&ba[a9].time.substr(0,2)=="20"){var bb=ba[a9].time;ba[a9].time=new Date(bb.substr(0,4)+"-"+bb.substr(4,2)+"-"+bb.substr(6,2)+" "+bb.substr(8,2)+":"+bb.substr(10,2)+":"+bb.substr(12,2)).getTime()}this._data.push(ba[a9])}}else{if(ba instanceof Object){this._data.push(ba)}else{throw new Error("Unknown dataType")}}};i.prototype.get=function(a8){a8=a8||{};var bc=new Date();var bb=this._data;var bc=new Date();if(a8.filter){var ba=[];for(var a9=0;a9<bb.length;a9++){if(a8.filter(bb[a9])){ba.push(bb[a9])}}bb=ba}if(a8.transferCoordinate){bb=this.transferCoordinate(bb,a8.transferCoordinate,a8.fromColumn,a8.toColumn)}return bb};i.prototype.set=function(a8){this._set(a8);this._trigger("change")};i.prototype._set=function(a8){this.clear();this.add(a8)};i.prototype.clear=function(a8){this._data=[]};i.prototype.remove=function(a8){};i.prototype.update=function(a8,be){var bd=this._data;var bc=null;for(var bb=0;bb<bd.length;bb++){if(be){var a9=true;for(var ba in be){if(bd[bb][ba]!=be[ba]){a9=false}}if(a9){a8&&a8(bd[bb])}}else{a8&&a8(bd[bb])}}this._trigger("change")};i.prototype.transferCoordinate=function(ba,a8,bh,bd){bd=bd||"_coordinates";bh=bh||"coordinates";for(var bb=0;bb<ba.length;bb++){var bf=ba[bb].geometry;var bj=bf[bh];switch(bf.type){case"Point":bf[bd]=a8(bj);break;case"LineString":var bi=[];for(var a9=0;a9<bj.length;a9++){bi.push(a8(bj[a9]))}bf[bd]=bi;break;case"Polygon":var bi=be(bj);bf[bd]=bi;break;case"MultiPolygon":var bi=[];for(var bc=0;bc<bj.length;bc++){var bg=bj[bc];var bg=be(bg);bi.push(bg)}bf[bd]=bi;break}}function be(bl){var bp=[];for(var bo=0;bo<bl.length;bo++){var bn=bl[bo];var bm=[];for(var bk=0;bk<bn.length;bk++){bm.push(a8(bn[bk]))}bp.push(bm)}return bp}return ba};i.prototype.initGeometry=function(a8){if(a8){this._data.forEach(function(a9){a9.geometry=a8(a9)})}else{this._data.forEach(function(a9){if(!a9.geometry&&a9.lng&&a9.lat){a9.geometry={type:"Point",coordinates:[a9.lng,a9.lat]}}})}};i.prototype.getMax=function(a9){var bc=this._data;if(!bc||bc.length<=0){return}var a8=parseFloat(bc[0][a9]);for(var ba=1;ba<bc.length;ba++){var bb=parseFloat(bc[ba][a9]);if(bb>a8){a8=bb}}return a8};i.prototype.getSum=function(a8){var bb=this._data;if(!bb||bb.length<=0){return}var ba=0;for(var a9=0;a9<bb.length;a9++){if(bb[a9][a8]){ba+=parseFloat(bb[a9][a8])}}return ba};i.prototype.getMin=function(a8){var bc=this._data;if(!bc||bc.length<=0){return}var ba=parseFloat(bc[0][a8]);for(var a9=1;a9<bc.length;a9++){var bb=parseFloat(bc[a9][a8]);if(bb<ba){ba=bb}}return ba};var ay={drawDataSet:function aT(bc,bb,a9){var be=bb instanceof i?bb.get():bb;for(var ba=0,a8=be.length;ba<a8;ba++){var bd=be[ba];this.draw(bc,bd,a9)}},draw:function ar(a8,bc,bj){var bd=bc.geometry.type;var bh=bc.geometry._coordinates||bc.geometry.coordinates;var a9=bj.symbol||"circle";switch(bd){case"Point":var bi=bc._size||bc.size||bj._size||bj.size||5;if(bj.symbol==="rect"){a8.rect(bh[0]-bi/2,bh[1]-bi/2,bi,bi)}else{if(bj.bigData==="Point"){a8.moveTo(bh[0],bh[1])}a8.arc(bh[0],bh[1],bi,0,Math.PI*2)}break;case"LineString":for(var ba=0;ba<bh.length;ba++){var bg=bh[ba][0];var be=bh[ba][1];if(ba==0){a8.moveTo(bg,be)}else{a8.lineTo(bg,be)}}break;case"Polygon":this.drawPolygon(a8,bh);break;case"MultiPolygon":for(var bb=0;bb<bh.length;bb++){var bf=bh[bb];this.drawPolygon(a8,bf)}a8.closePath();break;default:console.log("type"+bd+"is not support now!");break}},drawPolygon:function aM(ba,bb){for(var a9=0;a9<bb.length;a9++){var bc=bb[a9];ba.moveTo(bc[0][0],bc[0][1]);for(var a8=1;a8<bc.length;a8++){ba.lineTo(bc[a8][0],bc[a8][1])}ba.lineTo(bc[0][0],bc[0][1])}}};var aU={draw:function ar(a8,ba,bg){var a9=ba instanceof i?ba.get():ba;a8.save();for(var be in bg){a8[be]=bg[be]}if(bg.bigData){a8.save();a8.beginPath();for(var bb=0,bc=a9.length;bb<bc;bb++){var bf=a9[bb];ay.draw(a8,bf,bg)}var bd=bg.bigData;if(bd=="Point"||bd=="Polygon"||bd=="MultiPolygon"){a8.fill();if((bf.strokeStyle||bg.strokeStyle)&&bg.lineWidth){a8.stroke()}}else{if(bd=="LineString"){a8.stroke()}}a8.restore()}else{for(var bb=0,bc=a9.length;bb<bc;bb++){var bf=a9[bb];a8.save();if(bf.fillStyle||bf._fillStyle){a8.fillStyle=bf.fillStyle||bf._fillStyle}if(bf.strokeStyle||bf._strokeStyle){a8.strokeStyle=bf.strokeStyle||bf._strokeStyle}var bd=bf.geometry.type;a8.beginPath();ay.draw(a8,bf,bg);if(bd=="Point"||bd=="Polygon"||bd=="MultiPolygon"){a8.fill();if((bf.strokeStyle||bg.strokeStyle)&&bg.lineWidth){a8.stroke()}}else{if(bd=="LineString"){a8.stroke()}}a8.restore()}}a8.restore()}};function k(bb,a9){var ba;if(typeof document==="undefined"){var a8=require("canvas");ba=new a8(bb,a9)}else{var ba=document.createElement("canvas");if(bb){ba.width=bb}if(a9){ba.height=a9}}return ba}function p(a8){a8=a8||{};this.gradient=a8.gradient||{0.25:"rgba(0, 0, 255, 1)",0.55:"rgba(0, 255, 0, 1)",0.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"};this.maxSize=a8.maxSize||35;this.minSize=a8.minSize||0;this.max=a8.max||100;this.min=a8.min||0;this.initPalette()}p.prototype.setMax=function(a8){this.max=a8||100};p.prototype.setMin=function(a8){this.min=a8||0};p.prototype.setMaxSize=function(a8){this.maxSize=a8||35};p.prototype.setMinSize=function(a8){this.minSize=a8||0};p.prototype.initPalette=function(){var bb=this.gradient;var a8=new k(256,1);var ba=this.paletteCtx=a8.getContext("2d");var bc=ba.createLinearGradient(0,0,256,1);for(var a9 in bb){bc.addColorStop(parseFloat(a9),bb[a9])}ba.fillStyle=bc;ba.fillRect(0,0,256,1)};p.prototype.getColor=function(a8){var a9=this.getImageData(a8);return"rgba("+a9[0]+", "+a9[1]+", "+a9[2]+", "+a9[3]/256+")"};p.prototype.getImageData=function(bb){var bc=this.paletteCtx.getImageData(0,0,256,1).data;if(bb===undefined){return bc}var a8=this.max;var ba=this.min;if(bb>a8){bb=a8}if(bb<ba){bb=ba}var a9=Math.floor((bb-ba)/(a8-ba)*(256-1))*4;return[bc[a9],bc[a9+1],bc[a9+2],bc[a9+3]]};p.prototype.getSize=function(bb){var ba=0;var a8=this.max;var a9=this.min;var bd=this.maxSize;var bc=this.minSize;if(bb>a8){bb=a8}if(bb<a9){bb=a9}ba=bc+(bb-a9)/(a8-a9)*(bd-bc);return ba};p.prototype.getLegend=function(ba){var be=this.gradient;var bc=ba.width||20;var a8=ba.height||180;var a9=new k(bc,a8);var bd=a9.getContext("2d");var bf=bd.createLinearGradient(0,a8,0,0);for(var bb in be){bf.addColorStop(parseFloat(bb),be[bb])}bd.fillStyle=bf;bd.fillRect(0,0,bc,a8);return a9};var aB=typeof window==="undefined"?{}:window;var x=aB.devicePixelRatio;function v(bb){var a8=bb/2;var a9=bb+a8;var bd=10000;var bc=new k(a9*2,a9*2);var ba=bc.getContext("2d");ba.shadowBlur=a8;ba.shadowColor="black";ba.shadowOffsetX=ba.shadowOffsetY=bd;ba.beginPath();ba.arc(a9-bd,a9-bd,bb,0,Math.PI*2,true);ba.closePath();ba.fill();return bc}function aw(be,bc,ba){var bd=ba.maxOpacity||0.8;for(var bb=3,a8=be.length,a9;bb<a8;bb+=4){a9=be[bb]*4;if(be[bb]/256>bd){be[bb]=256*bd}be[bb-3]=bc[a9];be[bb-2]=bc[a9+1];be[bb-1]=bc[a9+2]}}function a1(ba,bg,bl){var bi=bl.max||100;var bd=bl.min||0;var bk=bl._size;if(bk==undefined){bk=bl.size;if(bk==undefined){bk=13}}var bc=new p({gradient:bl.gradient,max:bi,min:bd});var a9=v(bk);var bj=a9.width/2;var a8=a9.height/2;var bf=bg;var bh={};bf.forEach(function(bo,bm){var bn=bo.count===undefined?1:bo.count;var bp=Math.min(1,bn/bi).toFixed(2);bh[bp]=bh[bp]||[];bh[bp].push(bo)});for(var be in bh){if(isNaN(be)){continue}var bb=bh[be];ba.beginPath();if(!bl.withoutAlpha){ba.globalAlpha=be}ba.strokeStyle=bc.getColor(be*bi);bb.forEach(function(bp,bm){if(!bp.geometry){return}var bq=bp.geometry._coordinates||bp.geometry.coordinates;var bn=bp.geometry.type;if(bn==="Point"){var bo=bp.count===undefined?1:bp.count;ba.globalAlpha=bo/bi;ba.drawImage(a9,bq[0]-bj,bq[1]-a8)}else{if(bn==="LineString"){var bo=bp.count===undefined?1:bp.count;ba.globalAlpha=bo/bi;ba.beginPath();ay.draw(ba,bp,bl);ba.stroke()}else{if(bn==="Polygon"){}}}})}}function ar(a9,bd,bg){var ba=bg.strength||0.3;a9.strokeStyle="rgba(0,0,0,"+ba+")";var bf=new k(a9.canvas.width,a9.canvas.height);var a8=bf.getContext("2d");a8.scale(x,x);bg=bg||{};var bc=bd instanceof i?bd.get():bd;a9.save();var bb=new p({gradient:bg.gradient});a1(a8,bc,bg);if(!bg.absolute){var be=a8.getImageData(0,0,a9.canvas.width,a9.canvas.height);aw(be.data,bb.getImageData(),bg);a9.putImageData(be,0,0);a9.restore()}bb=null;bf=null}var aE={draw:ar};var aI={draw:function ar(a8,bd,bk){a8.save();var bc=bd instanceof i?bd.get():bd;var ba={};var bj=bk._size||bk.size||50;var bb=bk.offset||{x:0,y:0};for(var be=0;be<bc.length;be++){var bh=bc[be].geometry._coordinates||bc[be].geometry.coordinates;var bg=Math.floor((bh[0]-bb.x)/bj)+","+Math.floor((bh[1]-bb.y)/bj);if(!ba[bg]){ba[bg]=0}ba[bg]+=~~(bc[be].count||1)}var a9=new p({max:bk.max||100,gradient:bk.gradient});for(var bg in ba){bg=bg.split(",");a8.beginPath();a8.rect(bg[0]*bj+0.5+bb.x,bg[1]*bj+0.5+bb.y,bj,bj);a8.fillStyle=a9.getColor(ba[bg]);a8.fill();if(bk.strokeStyle&&bk.lineWidth){a8.stroke()}}if(bk.label&&bk.label.show!==false){a8.fillStyle=bk.label.fillStyle||"white";if(bk.label.font){a8.font=bk.label.font}if(bk.label.shadowColor){a8.shadowColor=bk.label.shadowColor}if(bk.label.shadowBlur){a8.shadowBlur=bk.label.shadowBlur}for(var bg in ba){bg=bg.split(",");var bi=ba[bg];var bf=a8.measureText(bi).width;a8.fillText(bi,bg[0]*bj+0.5+bb.x+bj/2-bf/2,bg[1]*bj+0.5+bb.y+bj/2+5)}}a8.restore()}};function U(a8,bb,ba){var bc=60*ba+30;var a9=Math.PI/180*bc;return[a8.x+bb*Math.cos(a9),a8.y+bb*Math.sin(a9)]}var an={draw:function ar(ba,bw,bd){ba.save();var bD=bw instanceof i?bw.get():bw;for(var bE in bd){ba[bE]=bd[bE]}var bf={};var bh=bd.offset||{x:10,y:10};var bp=bd._size||bd.size||40;bp=bp/2/Math.sin(Math.PI/3);var bl=bp*2*Math.sin(Math.PI/3);var bk=bp*1.5;var bq={};for(var by=0;by<bD.length;by++){var bc=bD[by].geometry._coordinates||bD[by].geometry.coordinates;var bn=(bc[1]-bh.y)/bk,bA=Math.round(bn),bo=(bc[0]-bh.x)/bl-(bA&1?0.5:0),bB=Math.round(bo),a9=bn-bA;if(Math.abs(a9)*3>1){var bx=bo-bB,bt=bB+(bo<bB?-1:1)/2,bC=bA+(bn<bA?-1:1),bv=bo-bt,a8=bn-bC;if(bx*bx+a9*a9>bv*bv+a8*a8){bB=bt+(bA&1?1:-1)/2,bA=bC}}var bs=bB+"-"+bA,br=bq[bs];if(br){br.push(bD[by])}else{br=bq[bs]=[bD[by]];br.i=bB;br.j=bA;br.x=(bB+(bA&1?1/2:0))*bl;br.y=bA*bk}}var bg=new p({max:bd.max||100,maxSize:bp,gradient:bd.gradient});for(var bE in bq){var bz=bq[bE];ba.beginPath();for(var bu=0;bu<6;bu++){var be=bp;var bj=U({x:bz.x+bh.x,y:bz.y+bh.y},be,bu);ba.lineTo(bj[0],bj[1])}ba.closePath();var bi=0;for(var by=0;by<bz.length;by++){bi+=bz[by].count||1}bz.count=bi;ba.fillStyle=bg.getColor(bi);ba.fill();if(bd.strokeStyle&&bd.lineWidth){ba.stroke()}}if(bd.label&&bd.label.show!==false){ba.fillStyle=bd.label.fillStyle||"white";if(bd.label.font){ba.font=bd.label.font}if(bd.label.shadowColor){ba.shadowColor=bd.label.shadowColor}if(bd.label.shadowBlur){ba.shadowBlur=bd.label.shadowBlur}for(var bE in bq){var bz=bq[bE];var bm=bz.count;if(bm<0){bm=bm.toFixed(2)}else{bm=~~bm}var bb=ba.measureText(bm).width;ba.fillText(bm,bz.x+bh.x-bb/2,bz.y+bh.y+5)}}ba.restore()}};function X(bb,ba,a8){var a9=bb.createShader(a8);bb.shaderSource(a9,ba);bb.compileShader(a9);return a9}function W(bc,a9,bb){var ba=X(bc,a9,bc.VERTEX_SHADER);var a8=X(bc,bb,bc.FRAGMENT_SHADER);var bd=bc.createProgram();bc.attachShader(bd,ba);bc.attachShader(bd,a8);bc.linkProgram(bd);bc.useProgram(bd);return bd}function j(a9){var a8=document.createElement("canvas");var ba=a8.getContext("2d");a8.width=1;a8.height=1;ba.fillStyle=a9;ba.fillRect(0,0,1,1);return ba.getImageData(0,0,1,1).data}var T=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join("");var f=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function aQ(bk,bp,a8){if(!bp){return}var bc=W(bk,T,f);bk.enable(bk.BLEND);bk.blendFunc(bk.SRC_ALPHA,bk.ONE);bk.clear(bk.COLOR_BUFFER_BIT);var bq=bk.canvas.width/2;var bh=bk.canvas.height/2;var bo=bk.createBuffer();bk.bindBuffer(bk.ARRAY_BUFFER,bo);var bd=bk.getAttribLocation(bc,"a_Position");bk.vertexAttribPointer(bd,2,bk.FLOAT,false,0,0);bk.enableVertexAttribArray(bd);var ba=bk.getUniformLocation(bc,"u_FragColor");var a9=j(a8.strokeStyle||"red");bk.uniform4f(ba,a9[0]/255,a9[1]/255,a9[2]/255,a9[3]/255);bk.lineWidth(a8.lineWidth||1);for(var bl=0,bm=bp.length;bl<bm;bl++){var bf=bp[bl].geometry._coordinates;var bi=[];for(var bj=0;bj<bf.length;bj++){var bn=bf[bj];var bg=(bn[0]-bq)/bq;var be=(bh-bn[1])/bh;bi.push(bg,be)}var bb=new Float32Array(bi);bk.bufferData(bk.ARRAY_BUFFER,bb,bk.STATIC_DRAW);bk.drawArrays(bk.LINE_STRIP,0,bf.length)}}var s={draw:aQ};var ac=["attribute vec4 a_Position;","attribute float a_PointSize;","void main() {","gl_Position = a_Position;","gl_PointSize = a_PointSize;","}"].join("");var a=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function aP(bl,bp,a8){if(!bp){return}var bd=W(bl,ac,a);var be=bl.getAttribLocation(bd,"a_Position");var bj=bl.getAttribLocation(bd,"a_PointSize");var ba=bl.getUniformLocation(bd,"u_FragColor");bl.clear(bl.COLOR_BUFFER_BIT);var bq=bl.canvas.width/2;var bh=bl.canvas.height/2;var bi=[];var bc=0;for(var bm=0;bm<bp.length;bm++){var bn=bp[bm].geometry._coordinates;var bg=(bn[0]-bq)/bq;var bf=(bh-bn[1])/bh;if(bg<-1||bg>1||bf<-1||bf>1){continue}bi.push(bg,bf);bc++}var bb=new Float32Array(bi);var bk=bc;var bo=bl.createBuffer();bl.bindBuffer(bl.ARRAY_BUFFER,bo);bl.bufferData(bl.ARRAY_BUFFER,bb,bl.STATIC_DRAW);bl.vertexAttribPointer(be,2,bl.FLOAT,false,0,0);bl.enableVertexAttribArray(be);bl.vertexAttrib1f(bj,a8._size);var a9=j(a8.fillStyle||"red");bl.uniform4f(ba,a9[0]/255,a9[1]/255,a9[2]/255,a9[3]/255);bl.drawArrays(bl.POINTS,0,bk)}var d={draw:aP};function aF(bf,bj,bg){bg=bg||2;var bh=bj&&bj.length,bd=bh?bj[0]*bg:bf.length,bi=aY(bf,0,bd,bg,true),bb=[];if(!bi){return bb}var bc,ba,a9,a8,bl,bk,bm;if(bh){bi=B(bf,bj,bi,bg)}if(bf.length>80*bg){bc=a9=bf[0];ba=a8=bf[1];for(var be=bg;be<bd;be+=bg){bl=bf[be];bk=bf[be+1];if(bl<bc){bc=bl}if(bk<ba){ba=bk}if(bl>a9){a9=bl}if(bk>a8){a8=bk}}bm=Math.max(a9-bc,a8-ba)}at(bi,bb,bg,bc,ba,bm);return bb}function aY(bc,be,a8,bd,a9){var ba,bb;if(a9===aj(bc,be,a8,bd)>0){for(ba=be;ba<a8;ba+=bd){bb=R(ba,bc[ba],bc[ba+1],bb)}}else{for(ba=a8-bd;ba>=be;ba-=bd){bb=R(ba,bc[ba],bc[ba+1],bb)}}if(bb&&G(bb,bb.next)){aV(bb);bb=bb.next}return bb}function al(bb,a8){if(!bb){return bb}if(!a8){a8=bb}var ba=bb,a9;do{a9=false;if(!ba.steiner&&(G(ba,ba.next)||h(ba.prev,ba,ba.next)===0)){aV(ba);ba=a8=ba.prev;if(ba===ba.next){return null}a9=true}else{ba=ba.next}}while(a9||ba!==a8);return a8}function at(a9,bb,be,bc,a8,bh,bg){if(!a9){return}if(!bg&&bh){ah(a9,bc,a8,bh)}var bf=a9,ba,bd;while(a9.prev!==a9.next){ba=a9.prev;bd=a9.next;if(bh?E(a9,bc,a8,bh):az(a9)){bb.push(ba.i/be);bb.push(a9.i/be);bb.push(bd.i/be);aV(a9);a9=bd.next;bf=bd.next;continue}a9=bd;if(a9===bf){if(!bg){at(al(a9),bb,be,bc,a8,bh,1)}else{if(bg===1){a9=L(a9,bb,be);at(a9,bb,be,bc,a8,bh,2)}else{if(bg===2){J(a9,bb,be,bc,a8,bh)}}}break}}}function az(ba){var a9=ba.prev,a8=ba,bc=ba.next;if(h(a9,a8,bc)>=0){return false}var bb=ba.next.next;while(bb!==ba.prev){if(aH(a9.x,a9.y,a8.x,a8.y,bc.x,bc.y,bb.x,bb.y)&&h(bb.prev,bb,bb.next)>=0){return false}bb=bb.next}return true}function E(bd,be,bc,bk){var bh=bd.prev,bg=bd,bf=bd.next;if(h(bh,bg,bf)>=0){return false}var bl=bh.x<bg.x?bh.x<bf.x?bh.x:bf.x:bg.x<bf.x?bg.x:bf.x,bi=bh.y<bg.y?bh.y<bf.y?bh.y:bf.y:bg.y<bf.y?bg.y:bf.y,bb=bh.x>bg.x?bh.x>bf.x?bh.x:bf.x:bg.x>bf.x?bg.x:bf.x,ba=bh.y>bg.y?bh.y>bf.y?bh.y:bf.y:bg.y>bf.y?bg.y:bf.y;var a9=b(bl,bi,be,bc,bk),bj=b(bb,ba,be,bc,bk);var a8=bd.nextZ;while(a8&&a8.z<=bj){if(a8!==bd.prev&&a8!==bd.next&&aH(bh.x,bh.y,bg.x,bg.y,bf.x,bf.y,a8.x,a8.y)&&h(a8.prev,a8,a8.next)>=0){return false}a8=a8.nextZ}a8=bd.prevZ;while(a8&&a8.z>=a9){if(a8!==bd.prev&&a8!==bd.next&&aH(bh.x,bh.y,bg.x,bg.y,bf.x,bf.y,a8.x,a8.y)&&h(a8.prev,a8,a8.next)>=0){return false}a8=a8.prevZ}return true}function L(bd,ba,bc){var bb=bd;do{var a9=bb.prev,a8=bb.next.next;if(!G(a9,a8)&&K(a9,bb,bb.next,a8)&&aA(a9,a8)&&aA(a8,a9)){ba.push(a9.i/bc);ba.push(bb.i/bc);ba.push(a8.i/bc);aV(bb);aV(bb.next);bb=bd=a8}bb=bb.next}while(bb!==bd);return bb}function J(a8,ba,bc,bb,a9,bg){var bf=a8;do{var be=bf.next.next;while(be!==bf.prev){if(bf.i!==be.i&&a0(bf,be)){var bd=y(bf,be);bf=al(bf,bf.next);bd=al(bd,bd.next);at(bf,ba,bc,bb,a9,bg);at(bd,ba,bc,bb,a9,bg);return}be=be.next}bf=bf.next}while(bf!==a8)}function B(ba,bh,bd,bc){var be=[],bb,bf,a8,a9,bg;for(bb=0,bf=bh.length;bb<bf;bb++){a8=bh[bb]*bc;a9=bb<bf-1?bh[bb+1]*bc:ba.length;bg=aY(ba,a8,a9,bc,false);if(bg===bg.next){bg.steiner=true}be.push(l(bg))}be.sort(O);for(bb=0;bb<be.length;bb++){F(be[bb],bd);bd=al(bd,bd.next)}return bd}function O(a9,a8){return a9.x-a8.x}function F(ba,a9){a9=aX(ba,a9);if(a9){var a8=y(a9,ba);al(a8,a8.next)}}function aX(a8,bc){var a9=bc,be=a8.x,bd=a8.y,bb=-Infinity,ba;do{if(bd<=a9.y&&bd>=a9.next.y){var bh=a9.x+(bd-a9.y)*(a9.next.x-a9.x)/(a9.next.y-a9.y);if(bh<=be&&bh>bb){bb=bh;if(bh===be){if(bd===a9.y){return a9}if(bd===a9.next.y){return a9.next}}ba=a9.x<a9.next.x?a9:a9.next}}a9=a9.next}while(a9!==bc);if(!ba){return null}if(be===bb){return ba.prev}var bg=ba,bk=ba.x,bi=ba.y,bj=Infinity,bf;a9=ba.next;while(a9!==bg){if(be>=a9.x&&a9.x>=bk&&aH(bd<bi?be:bb,bd,bk,bi,bd<bi?bb:be,bd,a9.x,a9.y)){bf=Math.abs(bd-a9.y)/(be-a9.x);if((bf<bj||bf===bj&&a9.x>ba.x)&&aA(a9,a8)){ba=a9;bj=bf}}a9=a9.next}return ba}function ah(bc,a8,bb,a9){var ba=bc;do{if(ba.z===null){ba.z=b(ba.x,ba.y,a8,bb,a9)}ba.prevZ=ba.prev;ba.nextZ=ba.next;ba=ba.next}while(ba!==bc);ba.prevZ.nextZ=null;ba.prevZ=null;e(ba)}function e(be){var bb,ba,a9,bd,bf,a8,bg,bc,bh=1;do{ba=be;be=null;bf=null;a8=0;while(ba){a8++;a9=ba;bg=0;for(bb=0;bb<bh;bb++){bg++;a9=a9.nextZ;if(!a9){break}}bc=bh;while(bg>0||bc>0&&a9){if(bg===0){bd=a9;a9=a9.nextZ;bc--}else{if(bc===0||!a9){bd=ba;ba=ba.nextZ;bg--}else{if(ba.z<=a9.z){bd=ba;ba=ba.nextZ;bg--}else{bd=a9;a9=a9.nextZ;bc--}}}if(bf){bf.nextZ=bd}else{be=bd}bd.prevZ=bf;bf=bd}ba=a9}bf.nextZ=null;bh*=2}while(a8>1);return be}function b(a9,bc,a8,bb,ba){a9=32767*(a9-a8)/ba;bc=32767*(bc-bb)/ba;a9=(a9|a9<<8)&16711935;a9=(a9|a9<<4)&252645135;a9=(a9|a9<<2)&858993459;a9=(a9|a9<<1)&1431655765;bc=(bc|bc<<8)&16711935;bc=(bc|bc<<4)&252645135;bc=(bc|bc<<2)&858993459;bc=(bc|bc<<1)&1431655765;return a9|bc<<1}function l(ba){var a9=ba,a8=ba;do{if(a9.x<a8.x){a8=a9}a9=a9.next}while(a9!==ba);return a8}function aH(bc,bb,be,bd,a8,bf,ba,a9){return(a8-ba)*(bb-a9)-(bc-ba)*(bf-a9)>=0&&(bc-ba)*(bd-a9)-(be-ba)*(bb-a9)>=0&&(be-ba)*(bf-a9)-(a8-ba)*(bd-a9)>=0}function a0(a9,a8){return a9.next.i!==a8.i&&a9.prev.i!==a8.i&&!ao(a9,a8)&&aA(a9,a8)&&aA(a8,a9)&&D(a9,a8)}function h(ba,a9,a8){return(a9.y-ba.y)*(a8.x-a9.x)-(a9.x-ba.x)*(a8.y-a9.y)}function G(a9,a8){return a9.x===a8.x&&a9.y===a8.y}function K(ba,a8,a9,bb){if(G(ba,a8)&&G(a9,bb)||G(ba,bb)&&G(a9,a8)){return true}return h(ba,a8,a9)>0!==h(ba,a8,bb)>0&&h(a9,bb,ba)>0!==h(a9,bb,a8)>0}function ao(a9,a8){var ba=a9;do{if(ba.i!==a9.i&&ba.next.i!==a9.i&&ba.i!==a8.i&&ba.next.i!==a8.i&&K(ba,ba.next,a9,a8)){return true}ba=ba.next}while(ba!==a9);return false}function aA(a9,a8){return h(a9.prev,a9,a9.next)<0?h(a9,a8,a9.next)>=0&&h(a9,a9.prev,a8)>=0:h(a9,a8,a9.prev)<0||h(a9,a9.next,a8)<0}function D(ba,a9){var bd=ba,a8=false,bc=(ba.x+a9.x)/2,bb=(ba.y+a9.y)/2;do{if(bd.y>bb!==bd.next.y>bb&&bc<(bd.next.x-bd.x)*(bb-bd.y)/(bd.next.y-bd.y)+bd.x){a8=!a8}bd=bd.next}while(bd!==ba);return a8}function y(ba,a9){var a8=new aN(ba.i,ba.x,ba.y),bb=new aN(a9.i,a9.x,a9.y),bd=ba.next,bc=a9.prev;ba.next=a9;a9.prev=ba;a8.next=bd;bd.prev=a8;bb.next=a8;a8.prev=bb;bc.next=bb;bb.prev=bc;return bb}function R(a9,a8,bc,ba){var bb=new aN(a9,a8,bc);if(!ba){bb.prev=bb;bb.next=bb}else{bb.next=ba.next;bb.prev=ba;ba.next.prev=bb;ba.next=bb}return bb}function aV(a8){a8.next.prev=a8.prev;a8.prev.next=a8.next;if(a8.prevZ){a8.prevZ.nextZ=a8.nextZ}if(a8.nextZ){a8.nextZ.prevZ=a8.prevZ}}function aN(a9,a8,ba){this.i=a9;this.x=a8;this.y=ba;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}aF.deviation=function(bd,bi,bf,ba){var bg=bi&&bi.length;var bc=bg?bi[0]*bf:bd.length;var a9=Math.abs(aj(bd,0,bc,bf));if(bg){for(var be=0,bh=bi.length;be<bh;be++){var a8=bi[be]*bf;var bb=be<bh-1?bi[be+1]*bf:bd.length;a9-=Math.abs(aj(bd,a8,bb,bf))}}var bm=0;for(be=0;be<ba.length;be+=3){var bl=ba[be]*bf;var bk=ba[be+1]*bf;var bj=ba[be+2]*bf;bm+=Math.abs((bd[bl]-bd[bj])*(bd[bk+1]-bd[bl+1])-(bd[bl]-bd[bk])*(bd[bj+1]-bd[bl+1]))}return a9===0&&bm===0?0:Math.abs((bm-a9)/a9)};function aj(bc,be,a8,bd){var bb=0;for(var ba=be,a9=a8-bd;ba<a8;ba+=bd){bb+=(bc[a9]-bc[ba])*(bc[ba+1]+bc[a9+1]);a9=ba}return bb}aF.flatten=function(bc){var bd=bc[0][0].length,a8={vertices:[],holes:[],dimensions:bd},ba=0;for(var bb=0;bb<bc.length;bb++){for(var a9=0;a9<bc[bb].length;a9++){for(var be=0;be<bd;be++){a8.vertices.push(bc[bb][a9][be])}}if(bb>0){ba+=bc[bb-1].length;a8.holes.push(ba)}}return a8};var Z=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join("");var a7=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function aO(bl,bo,a9){if(!bo){return}bl.clear(bl.COLOR_BUFFER_BIT);bl.viewport(0,0,bl.canvas.width,bl.canvas.height);var be=W(bl,Z,a7);bl.enable(bl.BLEND);bl.blendFunc(bl.SRC_ALPHA,bl.ONE);var bp=bl.canvas.width/2;var bg=bl.canvas.height/2;bl.bindBuffer(bl.ARRAY_BUFFER,bl.createBuffer());bl.bindBuffer(bl.ELEMENT_ARRAY_BUFFER,bl.createBuffer());var bf=bl.getAttribLocation(be,"a_Position");bl.vertexAttribPointer(bf,2,bl.FLOAT,false,0,0);bl.enableVertexAttribArray(bf);var bb=bl.getUniformLocation(be,"u_FragColor");var ba=j(a9.fillStyle||"red");bl.uniform4f(bb,ba[0]/255,ba[1]/255,ba[2]/255,ba[3]/255);bl.lineWidth(a9.lineWidth||1);var bc=[];var bh=[];var a8=65536;var bj=0;for(var bm=0,bn=bo.length;bm<bn;bm++){var bq=aF.flatten(bo[bm].geometry._coordinates||bo[bm].geometry.coordinates);var bd=bq.vertices;bj=bc.length/2;for(var bk=0;bk<bd.length;bk+=2){bd[bk]=(bd[bk]-bp)/bp;bd[bk+1]=(bg-bd[bk+1])/bg}if((bc.length+bd.length)/2>a8){bl.bufferData(bl.ARRAY_BUFFER,new Float32Array(bc),bl.STATIC_DRAW);bl.bufferData(bl.ELEMENT_ARRAY_BUFFER,new Uint16Array(bh),bl.STATIC_DRAW);bl.drawElements(bl.TRIANGLES,bh.length,bl.UNSIGNED_SHORT,0);bc.length=0;bh.length=0;bj=0}for(var bk=0;bk<bd.length;bk++){bc.push(bd[bk])}var bi=aF(bd,bq.holes,bq.dimensions);for(var bk=0;bk<bi.length;bk++){bh.push(bi[bk]+bj)}}bl.bufferData(bl.ARRAY_BUFFER,new Float32Array(bc),bl.STATIC_DRAW);bl.bufferData(bl.ELEMENT_ARRAY_BUFFER,new Uint16Array(bh),bl.STATIC_DRAW);bl.drawElements(bl.TRIANGLES,bh.length,bl.UNSIGNED_SHORT,0);bl.bindBuffer(bl.ARRAY_BUFFER,null);bl.bindBuffer(bl.ELEMENT_ARRAY_BUFFER,null)}var H={draw:aO};var ad={draw:function ar(bb,a9,a8){var ba=a9 instanceof i?a9.get():a9;if(ba.length>0){if(ba[0].geometry.type=="LineString"){s.draw(bb,ba,a8)}else{if(ba[0].geometry.type=="Polygon"||ba[0].geometry.type=="MultiPolygon"){H.draw(bb,ba,a8)}else{d.draw(bb,ba,a8)}}}}};var aD={municipalities:[{n:"北京",g:"116.395645,39.929986|12"},{n:"上海",g:"121.487899,31.249162|12"},{n:"天津",g:"117.210813,39.14393|12"},{n:"重庆",g:"106.530635,29.544606|12"}],provinces:[{n:"安徽",g:"117.216005,31.859252|8",cities:[{n:"合肥",g:"117.282699,31.866942|12"},{n:"安庆",g:"117.058739,30.537898|13"},{n:"蚌埠",g:"117.35708,32.929499|13"},{n:"亳州",g:"115.787928,33.871211|13"},{n:"巢湖",g:"117.88049,31.608733|13"},{n:"池州",g:"117.494477,30.660019|14"},{n:"滁州",g:"118.32457,32.317351|13"},{n:"阜阳",g:"115.820932,32.901211|13"},{n:"淮北",g:"116.791447,33.960023|13"},{n:"淮南",g:"117.018639,32.642812|13"},{n:"黄山",g:"118.29357,29.734435|13"},{n:"六安",g:"116.505253,31.755558|13"},{n:"马鞍山",g:"118.515882,31.688528|13"},{n:"宿州",g:"116.988692,33.636772|13"},{n:"铜陵",g:"117.819429,30.94093|14"},{n:"芜湖",g:"118.384108,31.36602|12"},{n:"宣城",g:"118.752096,30.951642|13"}]},{n:"福建",g:"117.984943,26.050118|8",cities:[{n:"福州",g:"119.330221,26.047125|12"},{n:"龙岩",g:"117.017997,25.078685|13"},{n:"南平",g:"118.181883,26.643626|13"},{n:"宁德",g:"119.542082,26.656527|14"},{n:"莆田",g:"119.077731,25.44845|13"},{n:"泉州",g:"118.600362,24.901652|12"},{n:"三明",g:"117.642194,26.270835|14"},{n:"厦门",g:"118.103886,24.489231|12"},{n:"漳州",g:"117.676205,24.517065|12"}]},{n:"甘肃",g:"102.457625,38.103267|6",cities:[{n:"兰州",g:"103.823305,36.064226|12"},{n:"白银",g:"104.171241,36.546682|13"},{n:"定西",g:"104.626638,35.586056|13"},{n:"甘南州",g:"102.917442,34.992211|14"},{n:"嘉峪关",g:"98.281635,39.802397|13"},{n:"金昌",g:"102.208126,38.516072|13"},{n:"酒泉",g:"98.508415,39.741474|13"},{n:"临夏州",g:"103.215249,35.598514|13"},{n:"陇南",g:"104.934573,33.39448|14"},{n:"平凉",g:"106.688911,35.55011|13"},{n:"庆阳",g:"107.644227,35.726801|13"},{n:"天水",g:"105.736932,34.584319|13"},{n:"武威",g:"102.640147,37.933172|13"},{n:"张掖",g:"100.459892,38.93932|13"}]},{n:"广东",g:"113.394818,23.408004|8",cities:[{n:"广州",g:"113.30765,23.120049|12"},{n:"潮州",g:"116.630076,23.661812|13"},{n:"东莞",g:"113.763434,23.043024|12"},{n:"佛山",g:"113.134026,23.035095|13"},{n:"河源",g:"114.713721,23.757251|12"},{n:"惠州",g:"114.410658,23.11354|12"},{n:"江门",g:"113.078125,22.575117|13"},{n:"揭阳",g:"116.379501,23.547999|13"},{n:"茂名",g:"110.931245,21.668226|13"},{n:"梅州",g:"116.126403,24.304571|13"},{n:"清远",g:"113.040773,23.698469|13"},{n:"汕头",g:"116.72865,23.383908|13"},{n:"汕尾",g:"115.372924,22.778731|14"},{n:"韶关",g:"113.594461,24.80296|13"},{n:"深圳",g:"114.025974,22.546054|12"},{n:"阳江",g:"111.97701,21.871517|14"},{n:"云浮",g:"112.050946,22.937976|13"},{n:"湛江",g:"110.365067,21.257463|13"},{n:"肇庆",g:"112.479653,23.078663|13"},{n:"中山",g:"113.42206,22.545178|12"},{n:"珠海",g:"113.562447,22.256915|13"}]},{n:"广西",g:"108.924274,23.552255|7",cities:[{n:"南宁",g:"108.297234,22.806493|12"},{n:"百色",g:"106.631821,23.901512|13"},{n:"北海",g:"109.122628,21.472718|13"},{n:"崇左",g:"107.357322,22.415455|14"},{n:"防城港",g:"108.351791,21.617398|15"},{n:"桂林",g:"110.26092,25.262901|12"},{n:"贵港",g:"109.613708,23.103373|13"},{n:"河池",g:"108.069948,24.699521|14"},{n:"贺州",g:"111.552594,24.411054|14"},{n:"来宾",g:"109.231817,23.741166|14"},{n:"柳州",g:"109.422402,24.329053|12"},{n:"钦州",g:"108.638798,21.97335|13"},{n:"梧州",g:"111.305472,23.485395|13"},{n:"玉林",g:"110.151676,22.643974|14"}]},{n:"贵州",g:"106.734996,26.902826|8",cities:[{n:"贵阳",g:"106.709177,26.629907|12"},{n:"安顺",g:"105.92827,26.228595|13"},{n:"毕节地区",g:"105.300492,27.302612|14"},{n:"六盘水",g:"104.852087,26.591866|13"},{n:"铜仁地区",g:"109.196161,27.726271|14"},{n:"遵义",g:"106.93126,27.699961|13"},{n:"黔西南州",g:"104.900558,25.095148|11"},{n:"黔东南州",g:"107.985353,26.583992|11"},{n:"黔南州",g:"107.523205,26.264536|11"}]},{n:"海南",g:"109.733755,19.180501|9",cities:[{n:"海口",g:"110.330802,20.022071|13"},{n:"白沙",g:"109.358586,19.216056|12"},{n:"保亭",g:"109.656113,18.597592|12"},{n:"昌江",g:"109.0113,19.222483|12"},{n:"儋州",g:"109.413973,19.571153|13"},{n:"澄迈",g:"109.996736,19.693135|13"},{n:"东方",g:"108.85101,18.998161|13"},{n:"定安",g:"110.32009,19.490991|13"},{n:"琼海",g:"110.414359,19.21483|13"},{n:"琼中",g:"109.861849,19.039771|12"},{n:"乐东",g:"109.062698,18.658614|12"},{n:"临高",g:"109.724101,19.805922|13"},{n:"陵水",g:"109.948661,18.575985|12"},{n:"三亚",g:"109.522771,18.257776|12"},{n:"屯昌",g:"110.063364,19.347749|13"},{n:"万宁",g:"110.292505,18.839886|13"},{n:"文昌",g:"110.780909,19.750947|13"},{n:"五指山",g:"109.51775,18.831306|13"}]},{n:"河北",g:"115.661434,38.61384|7",cities:[{n:"石家庄",g:"114.522082,38.048958|12"},{n:"保定",g:"115.49481,38.886565|13"},{n:"沧州",g:"116.863806,38.297615|13"},{n:"承德",g:"117.933822,40.992521|14"},{n:"邯郸",g:"114.482694,36.609308|13"},{n:"衡水",g:"115.686229,37.746929|13"},{n:"廊坊",g:"116.703602,39.518611|13"},{n:"秦皇岛",g:"119.604368,39.945462|12"},{n:"唐山",g:"118.183451,39.650531|13"},{n:"邢台",g:"114.520487,37.069531|13"},{n:"张家口",g:"114.893782,40.811188|13"}]},{n:"河南",g:"113.486804,34.157184|7",cities:[{n:"郑州",g:"113.649644,34.75661|12"},{n:"安阳",g:"114.351807,36.110267|12"},{n:"鹤壁",g:"114.29777,35.755426|13"},{n:"焦作",g:"113.211836,35.234608|13"},{n:"开封",g:"114.351642,34.801854|13"},{n:"洛阳",g:"112.447525,34.657368|12"},{n:"漯河",g:"114.046061,33.576279|13"},{n:"南阳",g:"112.542842,33.01142|13"},{n:"平顶山",g:"113.300849,33.745301|13"},{n:"濮阳",g:"115.026627,35.753298|12"},{n:"三门峡",g:"111.181262,34.78332|13"},{n:"商丘",g:"115.641886,34.438589|13"},{n:"新乡",g:"113.91269,35.307258|13"},{n:"信阳",g:"114.085491,32.128582|13"},{n:"许昌",g:"113.835312,34.02674|13"},{n:"周口",g:"114.654102,33.623741|13"},{n:"驻马店",g:"114.049154,32.983158|13"}]},{n:"黑龙江",g:"128.047414,47.356592|6",cities:[{n:"哈尔滨",g:"126.657717,45.773225|12"},{n:"大庆",g:"125.02184,46.596709|12"},{n:"大兴安岭地区",g:"124.196104,51.991789|10"},{n:"鹤岗",g:"130.292472,47.338666|13"},{n:"黑河",g:"127.50083,50.25069|14"},{n:"鸡西",g:"130.941767,45.32154|13"},{n:"佳木斯",g:"130.284735,46.81378|12"},{n:"牡丹江",g:"129.608035,44.588521|13"},{n:"七台河",g:"131.019048,45.775005|14"},{n:"齐齐哈尔",g:"123.987289,47.3477|13"},{n:"双鸭山",g:"131.171402,46.655102|13"},{n:"绥化",g:"126.989095,46.646064|13"},{n:"伊春",g:"128.910766,47.734685|14"}]},{n:"湖北",g:"112.410562,31.209316|8",cities:[{n:"武汉",g:"114.3162,30.581084|12"},{n:"鄂州",g:"114.895594,30.384439|14"},{n:"恩施",g:"109.517433,30.308978|14"},{n:"黄冈",g:"114.906618,30.446109|14"},{n:"黄石",g:"115.050683,30.216127|13"},{n:"荆门",g:"112.21733,31.042611|13"},{n:"荆州",g:"112.241866,30.332591|12"},{n:"潜江",g:"112.768768,30.343116|13"},{n:"神农架林区",g:"110.487231,31.595768|13"},{n:"十堰",g:"110.801229,32.636994|13"},{n:"随州",g:"113.379358,31.717858|13"},{n:"天门",g:"113.12623,30.649047|13"},{n:"仙桃",g:"113.387448,30.293966|13"},{n:"咸宁",g:"114.300061,29.880657|13"},{n:"襄阳",g:"112.176326,32.094934|12"},{n:"孝感",g:"113.935734,30.927955|13"},{n:"宜昌",g:"111.310981,30.732758|13"}]},{n:"湖南",g:"111.720664,27.695864|7",cities:[{n:"长沙",g:"112.979353,28.213478|12"},{n:"常德",g:"111.653718,29.012149|12"},{n:"郴州",g:"113.037704,25.782264|13"},{n:"衡阳",g:"112.583819,26.898164|13"},{n:"怀化",g:"109.986959,27.557483|13"},{n:"娄底",g:"111.996396,27.741073|13"},{n:"邵阳",g:"111.461525,27.236811|13"},{n:"湘潭",g:"112.935556,27.835095|13"},{n:"湘西州",g:"109.745746,28.317951|14"},{n:"益阳",g:"112.366547,28.588088|13"},{n:"永州",g:"111.614648,26.435972|13"},{n:"岳阳",g:"113.146196,29.378007|13"},{n:"张家界",g:"110.48162,29.124889|13"},{n:"株洲",g:"113.131695,27.827433|13"}]},{n:"江苏",g:"119.368489,33.013797|8",cities:[{n:"南京",g:"118.778074,32.057236|12"},{n:"常州",g:"119.981861,31.771397|12"},{n:"淮安",g:"119.030186,33.606513|12"},{n:"连云港",g:"119.173872,34.601549|12"},{n:"南通",g:"120.873801,32.014665|12"},{n:"苏州",g:"120.619907,31.317987|12"},{n:"宿迁",g:"118.296893,33.95205|13"},{n:"泰州",g:"119.919606,32.476053|13"},{n:"无锡",g:"120.305456,31.570037|12"},{n:"徐州",g:"117.188107,34.271553|12"},{n:"盐城",g:"120.148872,33.379862|12"},{n:"扬州",g:"119.427778,32.408505|13"},{n:"镇江",g:"119.455835,32.204409|13"}]},{n:"江西",g:"115.676082,27.757258|7",cities:[{n:"南昌",g:"115.893528,28.689578|12"},{n:"抚州",g:"116.360919,27.954545|13"},{n:"赣州",g:"114.935909,25.845296|13"},{n:"吉安",g:"114.992039,27.113848|13"},{n:"景德镇",g:"117.186523,29.303563|12"},{n:"九江",g:"115.999848,29.71964|13"},{n:"萍乡",g:"113.859917,27.639544|13"},{n:"上饶",g:"117.955464,28.457623|13"},{n:"新余",g:"114.947117,27.822322|13"},{n:"宜春",g:"114.400039,27.81113|13"},{n:"鹰潭",g:"117.03545,28.24131|13"}]},{n:"吉林",g:"126.262876,43.678846|7",cities:[{n:"长春",g:"125.313642,43.898338|12"},{n:"白城",g:"122.840777,45.621086|13"},{n:"白山",g:"126.435798,41.945859|13"},{n:"吉林市",g:"126.564544,43.871988|12"},{n:"辽源",g:"125.133686,42.923303|13"},{n:"四平",g:"124.391382,43.175525|12"},{n:"松原",g:"124.832995,45.136049|13"},{n:"通化",g:"125.94265,41.736397|13"},{n:"延边",g:"129.485902,42.896414|13"}]},{n:"辽宁",g:"122.753592,41.6216|8",cities:[{n:"沈阳",g:"123.432791,41.808645|12"},{n:"鞍山",g:"123.007763,41.118744|13"},{n:"本溪",g:"123.778062,41.325838|12"},{n:"朝阳",g:"120.446163,41.571828|13"},{n:"大连",g:"121.593478,38.94871|12"},{n:"丹东",g:"124.338543,40.129023|12"},{n:"抚顺",g:"123.92982,41.877304|12"},{n:"阜新",g:"121.660822,42.01925|14"},{n:"葫芦岛",g:"120.860758,40.74303|13"},{n:"锦州",g:"121.147749,41.130879|13"},{n:"辽阳",g:"123.172451,41.273339|14"},{n:"盘锦",g:"122.073228,41.141248|13"},{n:"铁岭",g:"123.85485,42.299757|13"},{n:"营口",g:"122.233391,40.668651|13"}]},{n:"内蒙古",g:"114.415868,43.468238|5",cities:[{n:"呼和浩特",g:"111.660351,40.828319|12"},{n:"阿拉善盟",g:"105.695683,38.843075|14"},{n:"包头",g:"109.846239,40.647119|12"},{n:"巴彦淖尔",g:"107.423807,40.76918|12"},{n:"赤峰",g:"118.930761,42.297112|12"},{n:"鄂尔多斯",g:"109.993706,39.81649|12"},{n:"呼伦贝尔",g:"119.760822,49.201636|12"},{n:"通辽",g:"122.260363,43.633756|12"},{n:"乌海",g:"106.831999,39.683177|13"},{n:"乌兰察布",g:"113.112846,41.022363|12"},{n:"锡林郭勒盟",g:"116.02734,43.939705|11"},{n:"兴安盟",g:"122.048167,46.083757|11"}]},{n:"宁夏",g:"106.155481,37.321323|8",cities:[{n:"银川",g:"106.206479,38.502621|12"},{n:"固原",g:"106.285268,36.021523|13"},{n:"石嘴山",g:"106.379337,39.020223|13"},{n:"吴忠",g:"106.208254,37.993561|14"},{n:"中卫",g:"105.196754,37.521124|14"}]},{n:"青海",g:"96.202544,35.499761|7",cities:[{n:"西宁",g:"101.767921,36.640739|12"},{n:"果洛州",g:"100.223723,34.480485|11"},{n:"海东地区",g:"102.085207,36.51761|11"},{n:"海北州",g:"100.879802,36.960654|11"},{n:"海南州",g:"100.624066,36.284364|11"},{n:"海西州",g:"97.342625,37.373799|11"},{n:"黄南州",g:"102.0076,35.522852|11"},{n:"玉树州",g:"97.013316,33.00624|14"}]},{n:"山东",g:"118.527663,36.09929|8",cities:[{n:"济南",g:"117.024967,36.682785|12"},{n:"滨州",g:"117.968292,37.405314|12"},{n:"东营",g:"118.583926,37.487121|12"},{n:"德州",g:"116.328161,37.460826|12"},{n:"菏泽",g:"115.46336,35.26244|13"},{n:"济宁",g:"116.600798,35.402122|13"},{n:"莱芜",g:"117.684667,36.233654|13"},{n:"聊城",g:"115.986869,36.455829|12"},{n:"临沂",g:"118.340768,35.072409|12"},{n:"青岛",g:"120.384428,36.105215|12"},{n:"日照",g:"119.50718,35.420225|12"},{n:"泰安",g:"117.089415,36.188078|13"},{n:"威海",g:"122.093958,37.528787|13"},{n:"潍坊",g:"119.142634,36.716115|12"},{n:"烟台",g:"121.309555,37.536562|12"},{n:"枣庄",g:"117.279305,34.807883|13"},{n:"淄博",g:"118.059134,36.804685|12"}]},{n:"山西",g:"112.515496,37.866566|7",cities:[{n:"太原",g:"112.550864,37.890277|12"},{n:"长治",g:"113.120292,36.201664|12"},{n:"大同",g:"113.290509,40.113744|12"},{n:"晋城",g:"112.867333,35.499834|13"},{n:"晋中",g:"112.738514,37.693362|13"},{n:"临汾",g:"111.538788,36.099745|13"},{n:"吕梁",g:"111.143157,37.527316|14"},{n:"朔州",g:"112.479928,39.337672|13"},{n:"忻州",g:"112.727939,38.461031|12"},{n:"阳泉",g:"113.569238,37.869529|13"},{n:"运城",g:"111.006854,35.038859|13"}]},{n:"陕西",g:"109.503789,35.860026|7",cities:[{n:"西安",g:"108.953098,34.2778|12"},{n:"安康",g:"109.038045,32.70437|13"},{n:"宝鸡",g:"107.170645,34.364081|12"},{n:"汉中",g:"107.045478,33.081569|13"},{n:"商洛",g:"109.934208,33.873907|13"},{n:"铜川",g:"108.968067,34.908368|13"},{n:"渭南",g:"109.483933,34.502358|13"},{n:"咸阳",g:"108.707509,34.345373|13"},{n:"延安",g:"109.50051,36.60332|13"},{n:"榆林",g:"109.745926,38.279439|12"}]},{n:"四川",g:"102.89916,30.367481|7",cities:[{n:"成都",g:"104.067923,30.679943|12"},{n:"阿坝州",g:"102.228565,31.905763|15"},{n:"巴中",g:"106.757916,31.869189|14"},{n:"达州",g:"107.494973,31.214199|14"},{n:"德阳",g:"104.402398,31.13114|13"},{n:"甘孜州",g:"101.969232,30.055144|15"},{n:"广安",g:"106.63572,30.463984|13"},{n:"广元",g:"105.819687,32.44104|13"},{n:"乐山",g:"103.760824,29.600958|13"},{n:"凉山州",g:"102.259591,27.892393|14"},{n:"泸州",g:"105.44397,28.89593|14"},{n:"南充",g:"106.105554,30.800965|13"},{n:"眉山",g:"103.84143,30.061115|13"},{n:"绵阳",g:"104.705519,31.504701|12"},{n:"内江",g:"105.073056,29.599462|13"},{n:"攀枝花",g:"101.722423,26.587571|14"},{n:"遂宁",g:"105.564888,30.557491|12"},{n:"雅安",g:"103.009356,29.999716|13"},{n:"宜宾",g:"104.633019,28.769675|13"},{n:"资阳",g:"104.63593,30.132191|13"},{n:"自贡",g:"104.776071,29.359157|13"}]},{n:"西藏",g:"89.137982,31.367315|6",cities:[{n:"拉萨",g:"91.111891,29.662557|13"},{n:"阿里地区",g:"81.107669,30.404557|11"},{n:"昌都地区",g:"97.185582,31.140576|15"},{n:"林芝地区",g:"94.349985,29.666941|11"},{n:"那曲地区",g:"92.067018,31.48068|14"},{n:"日喀则地区",g:"88.891486,29.269023|14"},{n:"山南地区",g:"91.750644,29.229027|11"}]},{n:"新疆",g:"85.614899,42.127001|6",cities:[{n:"乌鲁木齐",g:"87.564988,43.84038|12"},{n:"阿拉尔",g:"81.291737,40.61568|13"},{n:"阿克苏地区",g:"80.269846,41.171731|12"},{n:"阿勒泰地区",g:"88.137915,47.839744|13"},{n:"巴音郭楞",g:"86.121688,41.771362|12"},{n:"博尔塔拉州",g:"82.052436,44.913651|11"},{n:"昌吉州",g:"87.296038,44.007058|13"},{n:"哈密地区",g:"93.528355,42.858596|13"},{n:"和田地区",g:"79.930239,37.116774|13"},{n:"喀什地区",g:"75.992973,39.470627|12"},{n:"克拉玛依",g:"84.88118,45.594331|13"},{n:"克孜勒苏州",g:"76.137564,39.750346|11"},{n:"石河子",g:"86.041865,44.308259|13"},{n:"塔城地区",g:"82.974881,46.758684|12"},{n:"图木舒克",g:"79.198155,39.889223|13"},{n:"吐鲁番地区",g:"89.181595,42.96047|13"},{n:"五家渠",g:"87.565449,44.368899|13"},{n:"伊犁州",g:"81.297854,43.922248|11"}]},{n:"云南",g:"101.592952,24.864213|7",cities:[{n:"昆明",g:"102.714601,25.049153|12"},{n:"保山",g:"99.177996,25.120489|13"},{n:"楚雄州",g:"101.529382,25.066356|13"},{n:"大理州",g:"100.223675,25.5969|14"},{n:"德宏州",g:"98.589434,24.44124|14"},{n:"迪庆州",g:"99.713682,27.831029|14"},{n:"红河州",g:"103.384065,23.367718|11"},{n:"丽江",g:"100.229628,26.875351|13"},{n:"临沧",g:"100.092613,23.887806|14"},{n:"怒江州",g:"98.859932,25.860677|14"},{n:"普洱",g:"100.980058,22.788778|14"},{n:"曲靖",g:"103.782539,25.520758|12"},{n:"昭通",g:"103.725021,27.340633|13"},{n:"文山",g:"104.089112,23.401781|14"},{n:"西双版纳",g:"100.803038,22.009433|13"},{n:"玉溪",g:"102.545068,24.370447|13"}]},{n:"浙江",g:"119.957202,29.159494|8",cities:[{n:"杭州",g:"120.219375,30.259244|12"},{n:"湖州",g:"120.137243,30.877925|12"},{n:"嘉兴",g:"120.760428,30.773992|13"},{n:"金华",g:"119.652576,29.102899|12"},{n:"丽水",g:"119.929576,28.4563|13"},{n:"宁波",g:"121.579006,29.885259|12"},{n:"衢州",g:"118.875842,28.95691|12"},{n:"绍兴",g:"120.592467,30.002365|13"},{n:"台州",g:"121.440613,28.668283|13"},{n:"温州",g:"120.690635,28.002838|12"},{n:"舟山",g:"122.169872,30.03601|13"}]}],other:[{n:"香港",g:"114.186124,22.293586|11"},{n:"澳门",g:"113.557519,22.204118|13"},{n:"台湾",g:"120.961454,23.80406|8"}]};function I(a9){var a8=a9.split("|");a8[0]=a8[0].split(",");return{lng:parseFloat(a8[0][0]),lat:parseFloat(a8[0][1])}}var aR={getProvinceNameByCityName:function t(bb){var a9=aD.provinces;for(var bc=0;bc<a9.length;bc++){var a8=a9[bc].n;var bd=a9[bc].cities;for(var ba=0;ba<bd.length;ba++){if(bd[ba].n==bb){return a8}}}return null},getCenterByCityName:function a4(ba){for(var bb=0;bb<aD.municipalities.length;bb++){if(aD.municipalities[bb].n==ba){return I(aD.municipalities[bb].g)}}var a8=aD.provinces;for(var bb=0;bb<a8.length;bb++){if(a8[bb].n==ba){return I(a8[bb].g)}var bc=a8[bb].cities;for(var a9=0;a9<bc.length;a9++){if(bc[a9].n==ba){return I(bc[a9].g)}}}return null}};function ae(a9){var bb=[];for(var a8=0;a8<a9.length-1;a8++){var ba=au(a9[a8],a9[a8+1]);if(ba&&ba.length>0){bb=bb.concat(ba)}}return bb}function au(bp,bm){if(!bp||!bm){return null}var bg=function bg(bu){return 1-2*bu+bu*bu};var be=function be(bu){return 2*bu-2*bu*bu};var bd=function bd(bu){return bu*bu};var bq=[];var bb=40;var bn=false;var bi,bo,bc,a8,br,bk,bh;var bj=[];var bl=0;var bf=0;if(typeof bm=="undefined"){if(typeof bq!="undefined"){bq=[]}return}var ba=parseFloat(bp.lat);var a9=parseFloat(bm.lat);var bt=parseFloat(bp.lng);var bs=parseFloat(bm.lng);if(bs>bt){if(parseFloat(bs-bt)>180){if(bt<0){bt=parseFloat(180+180+bt)}}}if(bt>bs){if(parseFloat(bt-bs)>180){if(bs<0){bs=parseFloat(180+180+bs)}}}bk=0;bh=0;if(a9==ba){bi=0;bo=bt-bs}else{if(bs==bt){bi=Math.PI/2;bo=ba-a9}else{bi=Math.atan((a9-ba)/(bs-bt));bo=(a9-ba)/Math.sin(bi)}}if(bh==0){bh=bi+Math.PI/5}bc=bo/2;br=bc*Math.cos(bh)+bt;a8=bc*Math.sin(bh)+ba;for(bl=0;bl<bb+1;bl++){bq.push([bt*bg(bf)+br*be(bf)+bs*bd(bf),ba*bg(bf)+a8*be(bf)+a9*bd(bf)]);bf=bf+1/bb}return bq}var r={getPoints:ae};var w=function w(){var bb={},bx=[],bk=[],bc=[],bf=0.1,by=0.1,bl=1,bF=2,bh=6,bn=70,bi=0.6666667,bE=0.6,bj=false,bo=1e-8;function bw(bL,bK){return bL.x*bK.x+bL.y*bK.y}function bv(bK){return{x:bb[bK.target].x-bb[bK.source].x,y:bb[bK.target].y-bb[bK.source].y}}function bg(bK){return Math.sqrt(Math.pow(bb[bK.source].x-bb[bK.target].x,2)+Math.pow(bb[bK.source].y-bb[bK.target].y,2))}function bD(bK){return Math.sqrt(Math.pow(bK.source.x-bK.target.x,2)+Math.pow(bK.source.y-bK.target.y,2))}function bd(bL){var bK=(bb[bL.source].x+bb[bL.target].x)/2;var bM=(bb[bL.source].y+bb[bL.target].y)/2;return{x:bK,y:bM}}function bC(bL){var bN=0;for(var bM=1;bM<bc[bL].length;bM++){var bK=bB(bc[bL][bM],bc[bL][bM-1]);bN+=bK}return bN}function bB(bL,bK){return Math.sqrt(Math.pow(bL.x-bK.x,2)+Math.pow(bL.y-bK.y,2))}function bq(bN,bM){var bK=Math.sqrt((bM.target.x-bM.source.x)*(bM.target.x-bM.source.x)+(bM.target.y-bM.source.y)*(bM.target.y-bM.source.y));var bL=((bM.source.y-bN.y)*(bM.source.y-bM.target.y)-(bM.source.x-bN.x)*(bM.target.x-bM.source.x))/(bK*bK);return{x:bM.source.x+bL*(bM.target.x-bM.source.x),y:bM.source.y+bL*(bM.target.y-bM.source.y)}}function bH(){for(var bK=0;bK<bx.length;bK++){if(bl==1){bc[bK]=[]}else{bc[bK]=[];bc[bK].push(bb[bx[bK].source]);bc[bK].push(bb[bx[bK].target])}}}function bm(){for(var bK=0;bK<bx.length;bK++){bk[bK]=[]}}function bu(bM){var bL=[];for(var bK=0;bK<bM.length;bK++){if(bb[bM[bK].source].x!=bb[bM[bK].target].x&&bb[bM[bK].source].y!=bb[bM[bK].target].y){bL.push(bM[bK])}}return bL}function bp(bM,bN,bL){var bP=bc[bM][bN-1];var bO=bc[bM][bN+1];var bR=bc[bM][bN];var bK=bP.x-bR.x+bO.x-bR.x;var bQ=bP.y-bR.y+bO.y-bR.y;bK*=bL;bQ*=bL;return{x:bK,y:bQ}}function bG(bK,bN,bM){var bL={x:0,y:0};var bQ=bk[bK];for(var bR=0;bR<bQ.length;bR++){var bO={x:bc[bQ[bR]][bN].x-bc[bK][bN].x,y:bc[bQ[bR]][bN].y-bc[bK][bN].y};if(Math.abs(bO.x)>bo||Math.abs(bO.y)>bo){var bP=1/Math.pow(bD({source:bc[bQ[bR]][bN],target:bc[bK][bN]}),1);bL.x+=bO.x*bP;bL.y+=bO.y*bP}}return bL}function a9(bL,bR,bP){var bN=bf/(bg(bx[bL])*(bR+1));var bO=[{x:0,y:0}];for(var bQ=1;bQ<bR+1;bQ++){var bM={x:0,y:0};var bK=bp(bL,bQ,bN);var bS=bG(bL,bQ,bP);bM.x=bP*(bK.x+bS.x);bM.y=bP*(bK.y+bS.y);bO.push(bM)}bO.push({x:0,y:0});return bO}function bz(bT){for(var bN=0;bN<bx.length;bN++){if(bT==1){bc[bN].push(bb[bx[bN].source]);bc[bN].push(bd(bx[bN]));bc[bN].push(bb[bx[bN].target])}else{var bU=bC(bN);var bQ=bU/(bT+1);var bM=bQ;var bK=[];bK.push(bb[bx[bN].source]);for(var bR=1;bR<bc[bN].length;bR++){var bL=bB(bc[bN][bR],bc[bN][bR-1]);while(bL>bM){var bS=bM/bL;var bP=bc[bN][bR-1].x;var bO=bc[bN][bR-1].y;bP+=bS*(bc[bN][bR].x-bc[bN][bR-1].x);bO+=bS*(bc[bN][bR].y-bc[bN][bR-1].y);bK.push({x:bP,y:bO});bL-=bM;bM=bQ}bM-=bL}bK.push(bb[bx[bN].target]);bc[bN]=bK}}}function bA(bM,bL){var bK=Math.abs(bw(bv(bM),bv(bL))/(bg(bM)*bg(bL)));return bK}function bs(bN,bM){var bL=(bg(bN)+bg(bM))/2;var bK=2/(bL/Math.min(bg(bN),bg(bM))+Math.max(bg(bN),bg(bM))/bL);return bK}function br(bN,bM){var bL=(bg(bN)+bg(bM))/2;var bP={x:(bb[bN.source].x+bb[bN.target].x)/2,y:(bb[bN.source].y+bb[bN.target].y)/2};var bO={x:(bb[bM.source].x+bb[bM.target].x)/2,y:(bb[bM.source].y+bb[bM.target].y)/2};var bK=bL/(bL+bB(bP,bO));return bK}function be(bN,bM){var bP=bq(bb[bM.source],{source:bb[bN.source],target:bb[bN.target]});var bO=bq(bb[bM.target],{source:bb[bN.source],target:bb[bN.target]});var bL={x:(bP.x+bO.x)/2,y:(bP.y+bO.y)/2};var bQ={x:(bb[bN.source].x+bb[bN.target].x)/2,y:(bb[bN.source].y+bb[bN.target].y)/2};var bK=Math.max(0,1-2*bB(bQ,bL)/bB(bP,bO));return bK}function bt(bL,bK){return Math.min(be(bL,bK),be(bK,bL))}function ba(bM,bL){var bK=bA(bM,bL)*bs(bM,bL)*br(bM,bL)*bt(bM,bL);return bK}function bJ(bL,bK){return ba(bL,bK)>=bE}function a8(){for(var bK=0;bK<bx.length-1;bK++){for(var bL=bK+1;bL<bx.length;bL++){if(bK==bL){continue}else{if(bJ(bx[bK],bx[bL])){bk[bK].push(bL);bk[bL].push(bK)}}}}}var bI=function bI(){var bN=by;var bS=bn;var bQ=bl;bH();bm();bz(bQ);a8();for(var bO=0;bO<bh;bO++){for(var bL=0;bL<bS;bL++){var bM=[];for(var bK=0;bK<bx.length;bK++){bM[bK]=a9(bK,bQ,bN)}for(var bR=0;bR<bx.length;bR++){for(var bP=0;bP<bQ+1;bP++){bc[bR][bP].x+=bM[bR][bP].x;bc[bR][bP].y+=bM[bR][bP].y}}}bN=bN/2;bQ=bQ*2;bS=bi*bS;bz(bQ)}return bc};bI.nodes=function(bK){if(arguments.length==0){return bb}else{bb=bK}return bI};bI.edges=function(bK){if(arguments.length==0){return bx}else{bx=bu(bK)}return bI};bI.bundling_stiffness=function(bK){if(arguments.length==0){return bf}else{bf=bK}return bI};bI.step_size=function(bK){if(arguments.length==0){return by}else{by=bK}return bI};bI.cycles=function(bK){if(arguments.length==0){return bh}else{bh=bK}return bI};bI.iterations=function(bK){if(arguments.length==0){return bn}else{bn=bK}return bI};bI.iterations_rate=function(bK){if(arguments.length==0){return bi}else{bi=bK}return bI};bI.subdivision_points_seed=function(bK){if(arguments.length==0){return P}else{P=bK}return bI};bI.subdivision_rate=function(bK){if(arguments.length==0){return bF}else{bF=bK}return bI};bI.compatbility_threshold=function(bK){if(arguments.length==0){return compatbility_threshold}else{bE=bK}return bI};return bI};function c(a8){this.splitList=a8||{other:1}}c.prototype.get=function(ba){var a8=this.splitList;var bb=a8.other;for(var a9 in a8){if(ba==a9){bb=a8[a9];break}}return bb};c.prototype.generateByDataSet=function(ba){var a8=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"];var bc=ba.get();this.splitList={};var bb=0;for(var a9=0;a9<bc.length;a9++){if(this.splitList[bc[a9].count]===undefined){this.splitList[bc[a9].count]=a8[bb];bb++}if(bb>=a8.length-1){break}}this.splitList.other=a8[a8.length-1]};c.prototype.getLegend=function(ba){var a9=this.splitList;var a8=document.createElement("div");a8.style.cssText="background:#fff; padding: 5px; border: 1px solid #ccc;";var bc="";for(var bb in a9){bc+='<div style="line-height: 19px;"><span style="vertical-align: -2px; display: inline-block; width: 30px;height: 19px;background:'+a9[bb]+';"></span><span style="margin-left: 3px;">'+bb+"<span></div>"}a8.innerHTML=bc;return a8};function m(a8){this.splitList=a8||[{start:0,value:"red"}]}m.prototype.get=function(ba){var a8=this.splitList;var bb=false;for(var a9=0;a9<a8.length;a9++){if((a8[a9].start===undefined||a8[a9].start!==undefined&&ba>=a8[a9].start)&&(a8[a9].end===undefined||a8[a9].end!==undefined&&ba<a8[a9].end)){bb=a8[a9].value;break}}return bb};m.prototype.generateByDataSet=function(ba){var a9=ba.getMin("count");var a8=ba.getMax("count");this.generateByMinMax(a9,a8)};m.prototype.generateByMinMax=function(bb,a8){var a9=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"];var bd=(a8-bb)/7;var ba=bb;this.splitList=[];var bc=0;while(ba<a8){this.splitList.push({start:ba,end:ba+bd,value:a9[bc]});bc++;ba+=bd}};m.prototype.getLegend=function(a9){var a8=this.splitList};var aW=function(){function a8(bg,bd,bc){q(this,a8);if(!bg||!bd){console.warn("id 和 type 为必填项");return false}if(bd=="baidu"){if(!BMap){console.warn("请先引入百度地图JS API");return false}}else{console.warn("暂不支持你的地图类型")}this.type=bd;var bb=bc&&bc.center?bc.center:[106.962497,38.208726];var be=bc&&bc.zoom?bc.zoom:5;var bf=this.map=new BMap.Map(bg,{enableMapClick:false});bf.centerAndZoom(new BMap.Point(bb[0],bb[1]),be);bf.enableScrollWheelZoom(true);bf.setMapStyle({style:"light"})}a2(a8,[{key:"addLayer",value:function a9(bb,bc){if(this.type=="baidu"){return new mapv.baiduMapLayer(this.map,dataSet,bc)}}},{key:"getMap",value:function ba(){return this.map}}]);return a8}();function Y(a8){this.options=a8||{};this.paneName=this.options.paneName||"mapPane";this.context=this.options.context||"2d";this.zIndex=this.options.zIndex||0;this.mixBlendMode=this.options.mixBlendMode||null;this.enableMassClear=this.options.enableMassClear;this._map=a8.map;this._lastDrawTime=null;this.show()}var ax=typeof window==="undefined"?{}:window;if(ax.BMap){Y.prototype=new BMap.Overlay();Y.prototype.initialize=function(ba){this._map=ba;var a8=this.canvas=document.createElement("canvas");a8.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";user-select:none;";a8.style.mixBlendMode=this.mixBlendMode;this.adjustSize();ba.getPanes()[this.paneName].appendChild(a8);var a9=this;ba.addEventListener("resize",function(){a9.adjustSize();a9._draw()});return this.canvas};Y.prototype.adjustSize=function(){var ba=this._map.getSize();var a9=this.canvas;var a8=this.devicePixelRatio=ax.devicePixelRatio;a9.width=ba.width*a8;a9.height=ba.height*a8;if(this.context=="2d"){a9.getContext(this.context).scale(a8,a8)}a9.style.width=ba.width+"px";a9.style.height=ba.height+"px"};Y.prototype.draw=function(){var a8=this;clearTimeout(a8.timeoutID);a8.timeoutID=setTimeout(function(){a8._draw()},15)};Y.prototype._draw=function(){var bb=this._map;var ba=bb.getSize();var a8=bb.getCenter();if(a8){var a9=bb.pointToOverlayPixel(a8);this.canvas.style.left=a9.x-ba.width/2+"px";this.canvas.style.top=a9.y-ba.height/2+"px";this.dispatchEvent("draw");this.options.update&&this.options.update.call(this)}};Y.prototype.getContainer=function(){return this.canvas};Y.prototype.show=function(){if(!this.canvas){this._map.addOverlay(this)}this.canvas.style.display="block"};Y.prototype.hide=function(){this.canvas.style.display="none"};Y.prototype.setZIndex=function(a8){this.canvas.style.zIndex=a8};Y.prototype.getZIndex=function(){return this.zIndex}}var aq=aq||function(){var a9=[];return{getAll:function ba(){return a9},removeAll:function bb(){a9=[]},add:function bc(be){a9.push(be)},remove:function a8(bf){var be=a9.indexOf(bf);if(be!==-1){a9.splice(be,1)}},update:function bd(bg,bf){if(a9.length===0){return false}var be=0;bg=bg!==undefined?bg:aq.now();while(be<a9.length){if(a9[be].update(bg)||bf){be++}else{a9.splice(be,1)}}return true}}}();if(typeof window==="undefined"&&typeof process!=="undefined"){aq.now=function(){var a8=process.hrtime();return a8[0]*1000+a8[1]/1000000}}else{if(typeof window!=="undefined"&&window.performance!==undefined&&window.performance.now!==undefined){aq.now=window.performance.now.bind(window.performance)}else{if(Date.now!==undefined){aq.now=Date.now}else{aq.now=function(){return new Date().getTime()}}}}aq.Tween=function(br){var bd=br;var a8={};var bf={};var bg={};var bb=1000;var bm=0;var bs;var bn=false;var bi=false;var bc=false;var bp=0;var bq=null;var ba=aq.Easing.Linear.None;var bh=aq.Interpolation.Linear;var bj=[];var bk=null;var bl=false;var a9=null;var bo=null;var be=null;this.to=function(bt,bu){bf=bt;if(bu!==undefined){bb=bu}return this};this.start=function(bu){aq.add(this);bi=true;bl=false;bq=bu!==undefined?bu:aq.now();bq+=bp;for(var bt in bf){if(bf[bt] instanceof Array){if(bf[bt].length===0){continue}bf[bt]=[bd[bt]].concat(bf[bt])}if(bd[bt]===undefined){continue}a8[bt]=bd[bt];if(a8[bt] instanceof Array===false){a8[bt]*=1}bg[bt]=a8[bt]||0}return this};this.stop=function(){if(!bi){return this}aq.remove(this);bi=false;if(be!==null){be.call(bd,bd)}this.stopChainedTweens();return this};this.end=function(){this.update(bq+bb);return this};this.stopChainedTweens=function(){for(var bu=0,bt=bj.length;bu<bt;bu++){bj[bu].stop()}};this.delay=function(bt){bp=bt;return this};this.repeat=function(bt){bm=bt;return this};this.repeatDelay=function(bt){bs=bt;return this};this.yoyo=function(bt){bn=bt;return this};this.easing=function(bt){ba=bt;return this};this.interpolation=function(bt){bh=bt;return this};this.chain=function(){bj=arguments;return this};this.onStart=function(bt){bk=bt;return this};this.onUpdate=function(bt){a9=bt;return this};this.onComplete=function(bt){bo=bt;return this};this.onStop=function(bt){be=bt;return this};this.update=function(bu){var bA;var bB;var bz;if(bu<bq){return true}if(bl===false){if(bk!==null){bk.call(bd,bd)}bl=true}bB=(bu-bq)/bb;bB=bB>1?1:bB;bz=ba(bB);for(bA in bf){if(a8[bA]===undefined){continue}var bt=a8[bA]||0;var bv=bf[bA];if(bv instanceof Array){bd[bA]=bh(bv,bz)}else{if(typeof bv==="string"){if(bv.charAt(0)==="+"||bv.charAt(0)==="-"){bv=bt+parseFloat(bv)}else{bv=parseFloat(bv)}}if(typeof bv==="number"){bd[bA]=bt+(bv-bt)*bz}}}if(a9!==null){a9.call(bd,bz)}if(bB===1){if(bm>0){if(isFinite(bm)){bm--}for(bA in bg){if(typeof bf[bA]==="string"){bg[bA]=bg[bA]+parseFloat(bf[bA])}if(bn){var bw=bg[bA];bg[bA]=bf[bA];bf[bA]=bw}a8[bA]=bg[bA]}if(bn){bc=!bc}if(bs!==undefined){bq=bu+bs}else{bq=bu+bp}return true}else{if(bo!==null){bo.call(bd,bd)}for(var bx=0,by=bj.length;bx<by;bx++){bj[bx].start(bq+bb)}return false}}return true}};aq.Easing={Linear:{None:function u(a8){return a8}},Quadratic:{In:function af(a8){return a8*a8},Out:function aZ(a8){return a8*(2-a8)},InOut:function g(a8){if((a8*=2)<1){return 0.5*a8*a8}return -0.5*(--a8*(a8-2)-1)}},Cubic:{In:function af(a8){return a8*a8*a8},Out:function aZ(a8){return --a8*a8*a8+1},InOut:function g(a8){if((a8*=2)<1){return 0.5*a8*a8*a8}return 0.5*((a8-=2)*a8*a8+2)}},Quartic:{In:function af(a8){return a8*a8*a8*a8},Out:function aZ(a8){return 1- --a8*a8*a8*a8},InOut:function g(a8){if((a8*=2)<1){return 0.5*a8*a8*a8*a8}return -0.5*((a8-=2)*a8*a8*a8-2)}},Quintic:{In:function af(a8){return a8*a8*a8*a8*a8},Out:function aZ(a8){return --a8*a8*a8*a8*a8+1},InOut:function g(a8){if((a8*=2)<1){return 0.5*a8*a8*a8*a8*a8}return 0.5*((a8-=2)*a8*a8*a8*a8+2)}},Sinusoidal:{In:function af(a8){return 1-Math.cos(a8*Math.PI/2)},Out:function aZ(a8){return Math.sin(a8*Math.PI/2)},InOut:function g(a8){return 0.5*(1-Math.cos(Math.PI*a8))}},Exponential:{In:function af(a8){return a8===0?0:Math.pow(1024,a8-1)},Out:function aZ(a8){return a8===1?1:1-Math.pow(2,-10*a8)},InOut:function g(a8){if(a8===0){return 0}if(a8===1){return 1}if((a8*=2)<1){return 0.5*Math.pow(1024,a8-1)}return 0.5*(-Math.pow(2,-10*(a8-1))+2)}},Circular:{In:function af(a8){return 1-Math.sqrt(1-a8*a8)},Out:function aZ(a8){return Math.sqrt(1- --a8*a8)},InOut:function g(a8){if((a8*=2)<1){return -0.5*(Math.sqrt(1-a8*a8)-1)}return 0.5*(Math.sqrt(1-(a8-=2)*a8)+1)}},Elastic:{In:function af(a8){if(a8===0){return 0}if(a8===1){return 1}return -Math.pow(2,10*(a8-1))*Math.sin((a8-1.1)*5*Math.PI)},Out:function aZ(a8){if(a8===0){return 0}if(a8===1){return 1}return Math.pow(2,-10*a8)*Math.sin((a8-0.1)*5*Math.PI)+1},InOut:function g(a8){if(a8===0){return 0}if(a8===1){return 1}a8*=2;if(a8<1){return -0.5*Math.pow(2,10*(a8-1))*Math.sin((a8-1.1)*5*Math.PI)}return 0.5*Math.pow(2,-10*(a8-1))*Math.sin((a8-1.1)*5*Math.PI)+1}},Back:{In:function af(a8){var a9=1.70158;return a8*a8*((a9+1)*a8-a9)},Out:function aZ(a8){var a9=1.70158;return --a8*a8*((a9+1)*a8+a9)+1},InOut:function g(a8){var a9=1.70158*1.525;if((a8*=2)<1){return 0.5*(a8*a8*((a9+1)*a8-a9))}return 0.5*((a8-=2)*a8*((a9+1)*a8+a9)+2)}},Bounce:{In:function af(a8){return 1-aq.Easing.Bounce.Out(1-a8)},Out:function aZ(a8){if(a8<1/2.75){return 7.5625*a8*a8}else{if(a8<2/2.75){return 7.5625*(a8-=1.5/2.75)*a8+0.75}else{if(a8<2.5/2.75){return 7.5625*(a8-=2.25/2.75)*a8+0.9375}else{return 7.5625*(a8-=2.625/2.75)*a8+0.984375}}}},InOut:function g(a8){if(a8<0.5){return aq.Easing.Bounce.In(a8*2)*0.5}return aq.Easing.Bounce.Out(a8*2-1)*0.5+0.5}}};aq.Interpolation={Linear:function M(ba,a9){var a8=ba.length-1;var bd=a8*a9;var bb=Math.floor(bd);var bc=aq.Interpolation.Utils.Linear;if(a9<0){return bc(ba[0],ba[1],bd)}if(a9>1){return bc(ba[a8],ba[a8-1],a8-bd)}return bc(ba[bb],ba[bb+1>a8?a8:bb+1],bd-bb)},Bezier:function z(ba,a9){var a8=0;var be=ba.length-1;var bc=Math.pow;var bd=aq.Interpolation.Utils.Bernstein;for(var bb=0;bb<=be;bb++){a8+=bc(1-a9,be-bb)*bc(a9,bb)*ba[bb]*bd(be,bb)}return a8},CatmullRom:function o(ba,a9){var a8=ba.length-1;var bd=a8*a9;var bb=Math.floor(bd);var bc=aq.Interpolation.Utils.CatmullRom;if(ba[0]===ba[a8]){if(a9<0){bb=Math.floor(bd=a8*(1+a9))}return bc(ba[(bb-1+a8)%a8],ba[bb],ba[(bb+1)%a8],ba[(bb+2)%a8],bd-bb)}else{if(a9<0){return ba[0]-(bc(ba[0],ba[0],ba[1],ba[1],-bd)-ba[0])}if(a9>1){return ba[a8]-(bc(ba[a8],ba[a8],ba[a8-1],ba[a8-1],bd-a8)-ba[a8])}return bc(ba[bb?bb-1:0],ba[bb],ba[a8<bb+1?a8:bb+1],ba[a8<bb+2?a8:bb+2],bd-bb)}},Utils:{Linear:function M(ba,a9,a8){return(a9-ba)*a8+ba},Bernstein:function N(ba,a8){var a9=aq.Interpolation.Utils.Factorial;return a9(ba)/a9(a8)/a9(ba-a8)},Factorial:function(){var a8=[1];return function(bb){var ba=1;if(a8[bb]){return a8[bb]}for(var a9=bb;a9>1;a9--){ba*=a9}a8[bb]=ba;return ba}}(),CatmullRom:function o(bf,be,bc,bb,bg){var bd=(bc-bf)*0.5;var ba=(bb-be)*0.5;var a9=bg*bg;var a8=bg*a9;return(2*be-2*bc+bd+ba)*a8+(-3*be+3*bc-2*bd-ba)*a9+bd*bg+be}}};var a6={draw:function ar(a9,bm,bc){var bp=bm instanceof i?bm.get():bm;a9.save();for(var bq in bc){a9[bq]=bc[bq]}var be=bc.offset||{x:0,y:0};var bd=[];var bl=bc._size||bc.size;if(bl){a9.font="bold "+bl+"px Arial"}else{bl=12}var bh=bc.textKey||"text";if(!bc.textAlign){a9.textAlign="center"}if(!bc.textBaseline){a9.textBaseline="middle"}if(bc.avoid){for(var bn=0,bo=bp.length;bn<bo;bn++){var bb=bp[bn].geometry._coordinates||bp[bn].geometry.coordinates;var bg=bb[0]+be.x;var bf=bb[1]+be.y;var bi=bp[bn][bh];var ba=a9.measureText(bi).width;var bk=bg-ba/2;var bj=bf-bl/2;var a8={sw:{x:bk,y:bj+bl},ne:{x:bk+ba,y:bj}};if(!ak(bd,a8)){bd.push(a8);bk=bk+ba/2;bj=bj+bl/2;a9.fillText(bi,bk,bj)}}}else{for(var bn=0,bo=bp.length;bn<bo;bn++){var bb=bp[bn].geometry._coordinates||bp[bn].geometry.coordinates;var bg=bb[0]+be.x;var bf=bb[1]+be.y;var bi=bp[bn][bh];a9.fillText(bi,bg,bf)}}a9.restore()}};function ak(a8,a9){for(var ba=0;ba<a8.length;ba++){if(aL(a8[ba],a9)){return true}}return false}function aL(bb,ba){var a9=Math.min(bb.ne.x,ba.ne.x);var a8=Math.min(bb.sw.y,ba.sw.y);var bd=Math.max(bb.sw.x,ba.sw.x);var bc=Math.max(bb.ne.y,ba.ne.y);if(a9>bd&&a8>bc){return true}return false}var A={draw:function ar(ba,bd,bl){var bc=bd instanceof i?bd.get():bd;ba.fillStyle="white";ba.textAlign="center";ba.textBaseline="middle";var bb=bl.offset||{x:0,y:0};for(var be=0,bf=bc.length;be<bf;be++){if(bc[be].geometry){var a9=bc[be].deg||bl.deg;var bh=bc[be].icon||bl.icon;var bj=bc[be].geometry._coordinates||bc[be].geometry.coordinates;var bi=bj[0];var bg=bj[1];if(a9){ba.save();ba.translate(bi,bg);ba.rotate(a9*Math.PI/180);ba.translate(-bi,-bg)}var a8=bl._width||bl.width||bh.width;var bk=bl._height||bl.height||bh.height;bi=bi-a8/2+bb.x;bg=bg-bk/2+bb.y;if(bl.sx&&bl.sy&&bl.swidth&&bl.sheight&&bl.width&&bl.height){ba.drawImage(bh,bl.sx,bl.sy,bl.swidth,bl.sheight,bi,bg,a8,bk)}else{if(bl.width&&bl.height){ba.drawImage(bh,bi,bg,a8,bk)}else{ba.drawImage(bh,bi,bg)}}if(a9){ba.restore()}}}}};if(typeof window!=="undefined"){requestAnimationFrame(ab)}function ab(a8){requestAnimationFrame(ab);aq.update(a8)}var aS=function(){function bf(bt,bs,br){q(this,bf);if(!(bs instanceof i)){bs=new i(bs)}this.dataSet=bs;this.map=bt}a2(bf,[{key:"getDefaultContextConfig",value:function bo(){return{globalAlpha:1,globalCompositeOperation:"source-over",imageSmoothingEnabled:true,strokeStyle:"#000000",fillStyle:"#000000",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,lineDashOffset:0,font:"10px sans-serif",textAlign:"start",textBaseline:"alphabetic"}}},{key:"initDataRange",value:function bj(bt){var bs=this;bs.intensity=new p({maxSize:bs.options.maxSize,minSize:bs.options.minSize,gradient:bs.options.gradient,max:bs.options.max||this.dataSet.getMax("count")});bs.category=new c(bs.options.splitList);bs.choropleth=new m(bs.options.splitList);if(bs.options.splitList===undefined){bs.category.generateByDataSet(this.dataSet)}if(bs.options.splitList===undefined){var bu=bs.options.min||this.dataSet.getMin("count");var br=bs.options.max||this.dataSet.getMax("count");bs.choropleth.generateByMinMax(bu,br)}}},{key:"getLegend",value:function bq(bt){var br=this.options.draw;var bu=null;var bs=this;if(bs.options.draw=="intensity"||bs.options.draw=="heatmap"){return this.intensity.getLegend(bt)}else{if(bs.options.draw=="category"){return this.category.getLegend(bt)}}}},{key:"processData",value:function bb(bw){var bs=this;var br=bs.options.draw;if(br=="bubble"||br=="intensity"||br=="category"||br=="choropleth"||br=="simple"){for(var bt=0;bt<bw.length;bt++){var bv=bw[bt];if(bs.options.draw=="bubble"){bw[bt]._size=bs.intensity.getSize(bv.count)}else{bw[bt]._size=undefined}var bu="_fillStyle";if(bw[bt].geometry.type==="LineString"||bs.options.styleType==="stroke"){bu="_strokeStyle"}if(bs.options.draw=="intensity"){bw[bt][bu]=bs.intensity.getColor(bv.count)}else{if(bs.options.draw=="category"){bw[bt][bu]=bs.category.get(bv.count)}else{if(bs.options.draw=="choropleth"){bw[bt][bu]=bs.choropleth.get(bv.count)}}}}}}},{key:"isEnabledTime",value:function bc(){var bs=this.options.animation;var br=bs&&!(bs.enabled===false);return br}},{key:"argCheck",value:function be(br){if(br.draw=="heatmap"){if(br.strokeStyle){console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")}}}},{key:"drawContext",value:function ba(bu,bt,bs,bv){var br=this;switch(br.options.draw){case"heatmap":aE.draw(bu,bt,br.options);break;case"grid":case"honeycomb":br.options.offset={x:bv.x,y:bv.y};if(br.options.draw=="grid"){aI.draw(bu,bt,br.options)}else{an.draw(bu,bt,br.options)}break;case"text":a6.draw(bu,bt,br.options);break;case"icon":A.draw(bu,bt,br.options);break;case"clip":bu.save();bu.fillStyle=br.options.fillStyle||"rgba(0, 0, 0, 0.5)";bu.fillRect(0,0,bu.canvas.width,bu.canvas.height);aU.draw(bu,bt,br.options);bu.beginPath();ay.drawDataSet(bu,bt,br.options);bu.clip();ap(bu);bu.restore();break;default:if(br.options.context=="webgl"){ad.draw(br.canvasLayer.canvas.getContext("webgl"),bt,br.options)}else{aU.draw(bu,bt,br.options)}}}},{key:"isPointInPath",value:function bk(bu,bs){var bu=this.canvasLayer.canvas.getContext(this.context);var bv=this.dataSet.get();for(var bt=0;bt<bv.length;bt++){bu.beginPath();ay.draw(bu,bv[bt],this.options);var br=bs.x*this.canvasLayer.devicePixelRatio;var bw=bs.y*this.canvasLayer.devicePixelRatio;if(bu.isPointInPath(br,bw)||bu.isPointInStroke(br,bw)){return bv[bt]}}}},{key:"clickEvent",value:function a8(bs,bt){var br=this.isPointInPath(this.getContext(),bs);if(br){this.options.methods.click(br,bt)}else{this.options.methods.click(null,bt)}}},{key:"mousemoveEvent",value:function bg(bs,bt){var br=this.isPointInPath(this.getContext(),bs);if(br){this.options.methods.mousemove(br,bt)}else{this.options.methods.mousemove(null,bt)}}},{key:"update",value:function bh(bw,bs){var bt=this;var br=bw.options;var bu=bt.options;for(var bv in br){bu[bv]=br[bv]}bt.init(bu);if(bs!==false){bt.draw()}}},{key:"setOptions",value:function bl(bs){var br=this;br.init(bs);br.draw()}},{key:"set",value:function bn(bv){var bs=this;var br=this.getContext();var bt=this.getDefaultContextConfig();for(var bu in bt){br[bu]=bt[bu]}bs.init(bv.options);bs.draw()}},{key:"destroy",value:function bp(){this.unbindEvent();this.hide()}},{key:"initAnimator",value:function bm(){var br=this;var bt=br.options.animation;if(br.options.draw=="time"||br.isEnabledTime()){if(!bt.stepsRange){bt.stepsRange={start:this.dataSet.getMin("time")||0,end:this.dataSet.getMax("time")||0}}this.steps={step:bt.stepsRange.start};br.animator=new aq.Tween(this.steps).onUpdate(function(){br._canvasUpdate(this.step)}).repeat(Infinity);this.addAnimatorEvent();var bs=bt.duration*1000||5000;br.animator.to({step:bt.stepsRange.end},bs);br.animator.start()}else{br.animator&&br.animator.stop()}}},{key:"addAnimatorEvent",value:function bd(){}},{key:"animatorMovestartEvent",value:function a9(){var br=this.options.animation;if(this.isEnabledTime()&&this.animator){this.steps.step=br.stepsRange.start;this.animator.stop()}}},{key:"animatorMoveendEvent",value:function bi(){if(this.isEnabledTime()&&this.animator){this.animator.start()}}}]);return bf}();var am=function(be){aK(bb,be);function bb(bk,bj,bi){q(this,bb);var bm=a3(this,(bb.__proto__||Object.getPrototypeOf(bb)).call(this,bk,bj,bi));bm.map=bk;bm.options=bi||{};bm.dataSet=bj;bm.init(bi);var bl=new Y({map:bk,update:bm._canvasUpdate.bind(bm)});bm.transferToMercator();var bh=bm;bj.on("change",function(){bh.transferToMercator();bl.draw()});bm.ctx=bl.canvas.getContext("2d");bm.start();return bm}a2(bb,[{key:"init",value:function bf(bi){var bh=this;bh.options=bi;this.initDataRange(bi);this.context=bh.options.context||"2d";if(bh.options.zIndex){this.canvasLayer&&this.canvasLayer.setZIndex(bh.options.zIndex)}if(bh.options.max){this.intensity.setMax(bh.options.max)}if(bh.options.min){this.intensity.setMin(bh.options.min)}this.initAnimator()}},{key:"transferToMercator",value:function bc(){var bh=this.map.getMapType().getProjection();if(this.options.coordType!=="bd09mc"){var bi=this.dataSet.get();bi=this.dataSet.transferCoordinate(bi,function(bk){var bj=bh.lngLatToPoint({lng:bk[0],lat:bk[1]});return[bj.x,bj.y]},"coordinates","coordinates_mercator");this.dataSet._set(bi)}}},{key:"_canvasUpdate",value:function bg(){var bi=this.ctx;if(!bi){return}var bn=this.map;var bj=Math.pow(2,18-bn.getZoom());var bh=bn.getMapType().getProjection();var bl=bh.lngLatToPoint(bn.getCenter());var bm=new BMap.Pixel(bl.x-bn.getSize().width/2*bj,bl.y+bn.getSize().height/2*bj);ap(bi);var bo={fromColumn:this.options.coordType=="bd09mc"?"coordinates":"coordinates_mercator",transferCoordinate:function bk(br){if(!br){return}var bp=(br[0]-bm.x)/bj;var bq=(bm.y-br[1])/bj;return[bp,bq]}};this.data=this.dataSet.get(bo);this.processData(this.data);this.drawAnimation()}},{key:"drawAnimation",value:function ba(){var bo=this.ctx;var bi=this.data;if(!bi){return}bo.save();bo.globalCompositeOperation="destination-out";bo.fillStyle="rgba(0, 0, 0, .1)";bo.fillRect(0,0,bo.canvas.width,bo.canvas.height);bo.restore();bo.save();if(this.options.shadowColor){bo.shadowColor=this.options.shadowColor}if(this.options.shadowBlur){bo.shadowBlur=this.options.shadowBlur}if(this.options.globalAlpha){bo.globalAlpha=this.options.globalAlpha}if(this.options.globalCompositeOperation){bo.globalCompositeOperation=this.options.globalCompositeOperation}var bq=this.options;for(var bj=0;bj<bi.length;bj++){if(bi[bj].geometry.type==="Point"){bo.beginPath();var bm=bi[bj].size||this.options.size;var bh=bi[bj].minSize||this.options.minSize||0;if(bi[bj]._size===undefined){bi[bj]._size=bh}bo.arc(bi[bj].geometry._coordinates[0],bi[bj].geometry._coordinates[1],bi[bj]._size,0,Math.PI*2,true);bo.closePath();bi[bj]._size++;if(bi[bj]._size>bm){bi[bj]._size=bh}bo.lineWidth=1;bo.strokeStyle=bi[bj].strokeStyle||bi[bj]._strokeStyle||bq.strokeStyle||"yellow";bo.stroke();var bn=bi[bj].fillStyle||bi[bj]._fillStyle||bq.fillStyle;if(bn){bo.fillStyle=bn;bo.fill()}}else{if(bi[bj].geometry.type==="LineString"){bo.beginPath();var bp=bi[bj].size||this.options.size||5;var bh=bi[bj].minSize||this.options.minSize||0;if(bi[bj]._index===undefined){bi[bj]._index=0}var bk=bi[bj]._index;bo.arc(bi[bj].geometry._coordinates[bk][0],bi[bj].geometry._coordinates[bk][1],bp,0,Math.PI*2,true);bo.closePath();bi[bj]._index++;if(bi[bj]._index>=bi[bj].geometry._coordinates.length){bi[bj]._index=0}bo.lineWidth=bq.lineWidth||1;var bl=bi[bj].strokeStyle||bq.strokeStyle;var bn=bi[bj].fillStyle||bq.fillStyle||"yellow";bo.fillStyle=bn;bo.fill();if(bl){bo.strokeStyle=bl;bo.stroke()}}}}bo.restore()}},{key:"animate",value:function a9(){this.drawAnimation();var bh=this.options.animateTime||100;this.timeout=setTimeout(this.animate.bind(this),bh)}},{key:"start",value:function a8(){this.stop();this.animate()}},{key:"stop",value:function bd(){clearTimeout(this.timeout)}}]);return bb}(aS);var Q=function(bi){aK(a9,bi);function a9(bq,bo,bn){q(this,a9);var bt=a3(this,(a9.__proto__||Object.getPrototypeOf(a9)).call(this,bq,bo,bn));var bm=bt;var bp=null;bn=bn||{};bm.init(bn);bm.argCheck(bn);bm.transferToMercator();var bs=bt.canvasLayer=new Y({map:bq,context:bt.context,paneName:bn.paneName,mixBlendMode:bn.mixBlendMode,enableMassClear:bn.enableMassClear,zIndex:bn.zIndex,update:function br(){bm._canvasUpdate()}});bo.on("change",function(){bm.transferToMercator();bs.draw()});bt.clickEvent=bt.clickEvent.bind(bt);bt.mousemoveEvent=bt.mousemoveEvent.bind(bt);bt.bindEvent();return bt}a2(a9,[{key:"clickEvent",value:function bj(bn){var bm=bn.pixel;aJ(a9.prototype.__proto__||Object.getPrototypeOf(a9.prototype),"clickEvent",this).call(this,bm,bn)}},{key:"mousemoveEvent",value:function bh(bn){var bm=bn.pixel;aJ(a9.prototype.__proto__||Object.getPrototypeOf(a9.prototype),"mousemoveEvent",this).call(this,bm,bn)}},{key:"bindEvent",value:function bd(bn){var bm=this.map;if(this.options.methods){if(this.options.methods.click){bm.setDefaultCursor("default");bm.addEventListener("click",this.clickEvent)}if(this.options.methods.mousemove){bm.addEventListener("mousemove",this.mousemoveEvent)}}}},{key:"unbindEvent",value:function ba(bn){var bm=this.map;if(this.options.methods){if(this.options.methods.click){bm.removeEventListener("click",this.clickEvent)}if(this.options.methods.mousemove){bm.removeEventListener("mousemove",this.mousemoveEvent)}}}},{key:"transferToMercator",value:function bb(){var bm=this.map.getMapType().getProjection();if(this.options.coordType!=="bd09mc"){var bn=this.dataSet.get();bn=this.dataSet.transferCoordinate(bn,function(bp){var bo=bm.lngLatToPoint({lng:bp[0],lat:bp[1]});return[bo.x,bo.y]},"coordinates","coordinates_mercator");this.dataSet._set(bn)}}},{key:"getContext",value:function bg(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function bl(br){if(!this.canvasLayer){return}var bA=this;var bt=bA.options.animation;var bm=this.canvasLayer._map;var bo=Math.pow(2,18-bm.getZoom());var bw=bm.getMapType().getProjection();var bu=bw.lngLatToPoint(bm.getCenter());var bn=new BMap.Pixel(bu.x-bm.getSize().width/2*bo,bu.y+bm.getSize().height/2*bo);var bp=this.getContext();if(bA.isEnabledTime()){if(br===undefined){ap(bp);return}if(this.context=="2d"){bp.save();bp.globalCompositeOperation="destination-out";bp.fillStyle="rgba(0, 0, 0, .1)";bp.fillRect(0,0,bp.canvas.width,bp.canvas.height);bp.restore()}}else{ap(bp)}if(this.context=="2d"){for(var by in bA.options){bp[by]=bA.options[by]}}else{bp.clear(bp.COLOR_BUFFER_BIT)}if(bA.options.minZoom&&bm.getZoom()<bA.options.minZoom||bA.options.maxZoom&&bm.getZoom()>bA.options.maxZoom){return}var bs=1;if(this.context!="2d"){bs=this.canvasLayer.devicePixelRatio}var bz={fromColumn:bA.options.coordType=="bd09mc"?"coordinates":"coordinates_mercator",transferCoordinate:function bx(bD){var bB=(bD[0]-bn.x)/bo*bs;var bC=(bn.y-bD[1])/bo*bs;return[bB,bC]}};if(br!==undefined){bz.filter=function(bC){var bB=bt.trails||10;if(br&&bC.time>br-bB&&bC.time<br){return true}else{return false}}}var bv=bA.dataSet.get(bz);this.processData(bv);var bq=bm.pointToPixel(new BMap.Point(0,0));if(bA.options.unit=="m"){if(bA.options.size){bA.options._size=bA.options.size/bo}if(bA.options.width){bA.options._width=bA.options.width/bo}if(bA.options.height){bA.options._height=bA.options.height/bo}}else{bA.options._size=bA.options.size;bA.options._height=bA.options.height;bA.options._width=bA.options.width}this.drawContext(bp,bv,bA.options,bq);bA.options.updateCallback&&bA.options.updateCallback(br)}},{key:"init",value:function bk(bn){var bm=this;bm.options=bn;this.initDataRange(bn);this.context=bm.options.context||"2d";if(bm.options.zIndex){this.canvasLayer&&this.canvasLayer.setZIndex(bm.options.zIndex)}if(bm.options.max){this.intensity.setMax(bm.options.max)}if(bm.options.min){this.intensity.setMin(bm.options.min)}this.initAnimator()}},{key:"addAnimatorEvent",value:function a8(){this.map.addEventListener("movestart",this.animatorMovestartEvent.bind(this));this.map.addEventListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function bf(){this.map.addOverlay(this.canvasLayer)}},{key:"hide",value:function bc(){this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function be(){this.canvasLayer.draw()}}]);return a9}(aS);function ag(a9){this.isAdded_=false;this.isAnimated_=false;this.paneName_=ag.DEFAULT_PANE_NAME_;this.updateHandler_=null;this.resizeHandler_=null;this.topLeft_=null;this.centerListener_=null;this.resizeListener_=null;this.needsResize_=true;this.requestAnimationFrameId_=null;var a8=document.createElement("canvas");a8.style.position="absolute";a8.style.top=0;a8.style.left=0;a8.style.pointerEvents="none";this.canvas=a8;this.canvasCssWidth_=300;this.canvasCssHeight_=150;this.resolutionScale_=1;function ba(bb,bc){return function(){bc.apply(bb)}}this.repositionFunction_=ba(this,this.repositionCanvas_);this.resizeFunction_=ba(this,this.resize_);this.requestUpdateFunction_=ba(this,this.update_);if(a9){this.setOptions(a9)}}var av=typeof window==="undefined"?{}:window;if(av.google&&av.google.maps){ag.prototype=new google.maps.OverlayView();ag.DEFAULT_PANE_NAME_="overlayLayer";ag.CSS_TRANSFORM_=function(){var bb=document.createElement("div");var a9=["transform","WebkitTransform","MozTransform","OTransform","msTransform"];for(var a8=0;a8<a9.length;a8++){var ba=a9[a8];if(bb.style[ba]!==undefined){return ba}}return a9[0]}();ag.prototype.requestAnimFrame_=av.requestAnimationFrame||av.webkitRequestAnimationFrame||av.mozRequestAnimationFrame||av.oRequestAnimationFrame||av.msRequestAnimationFrame||function(a8){return av.setTimeout(a8,1000/60)};ag.prototype.cancelAnimFrame_=av.cancelAnimationFrame||av.webkitCancelAnimationFrame||av.mozCancelAnimationFrame||av.oCancelAnimationFrame||av.msCancelAnimationFrame||function(a8){};ag.prototype.setOptions=function(a8){if(a8.animate!==undefined){this.setAnimate(a8.animate)}if(a8.paneName!==undefined){this.setPaneName(a8.paneName)}if(a8.updateHandler!==undefined){this.setUpdateHandler(a8.updateHandler)}if(a8.resizeHandler!==undefined){this.setResizeHandler(a8.resizeHandler)}if(a8.resolutionScale!==undefined){this.setResolutionScale(a8.resolutionScale)}if(a8.map!==undefined){this.setMap(a8.map)}};ag.prototype.setAnimate=function(a8){this.isAnimated_=!!a8;if(this.isAnimated_){this.scheduleUpdate()}};ag.prototype.isAnimated=function(){return this.isAnimated_};ag.prototype.setPaneName=function(a8){this.paneName_=a8;this.setPane_()};ag.prototype.getPaneName=function(){return this.paneName_};ag.prototype.setPane_=function(){if(!this.isAdded_){return}var a8=this.getPanes();if(!a8[this.paneName_]){throw new Error('"'+this.paneName_+'" is not a valid MapPane name.')}a8[this.paneName_].appendChild(this.canvas)};ag.prototype.setResizeHandler=function(a8){this.resizeHandler_=a8};ag.prototype.setResolutionScale=function(a8){if(typeof a8==="number"){this.resolutionScale_=a8;this.resize_()}};ag.prototype.setUpdateHandler=function(a8){this.updateHandler_=a8};ag.prototype.onAdd=function(){if(this.isAdded_){return}this.isAdded_=true;this.setPane_();this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_);this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_);this.resize_();this.repositionCanvas_()};ag.prototype.onRemove=function(){if(!this.isAdded_){return}this.isAdded_=false;this.topLeft_=null;this.canvas.parentElement.removeChild(this.canvas);if(this.centerListener_){google.maps.event.removeListener(this.centerListener_);this.centerListener_=null}if(this.resizeListener_){google.maps.event.removeListener(this.resizeListener_);this.resizeListener_=null}if(this.requestAnimationFrameId_){this.cancelAnimFrame_.call(av,this.requestAnimationFrameId_);this.requestAnimationFrameId_=null}};ag.prototype.resize_=function(){if(!this.isAdded_){return}var bd=this.getMap();var ba=bd.getDiv().offsetWidth;var bc=bd.getDiv().offsetHeight;var bb=ba*this.resolutionScale_;var a9=bc*this.resolutionScale_;var a8=this.canvas.width;var be=this.canvas.height;if(a8!==bb||be!==a9){this.canvas.width=bb;this.canvas.height=a9;this.needsResize_=true;this.scheduleUpdate()}if(this.canvasCssWidth_!==ba||this.canvasCssHeight_!==bc){this.canvasCssWidth_=ba;this.canvasCssHeight_=bc;this.canvas.style.width=ba+"px";this.canvas.style.height=bc+"px"}};ag.prototype.draw=function(){this.repositionCanvas_()};ag.prototype.repositionCanvas_=function(){var a9=this.getMap();var bg=a9.getBounds().getNorthEast().lat();var a8=a9.getCenter();var bb=Math.pow(2,a9.getZoom());var ba=a8.lng()-this.canvasCssWidth_*180/(256*bb);this.topLeft_=new google.maps.LatLng(bg,ba);var bf=this.getProjection();var be=bf.fromLatLngToDivPixel(a8);var bd=-Math.round(this.canvasCssWidth_/2-be.x);var bc=-Math.round(this.canvasCssHeight_/2-be.y);this.canvas.style[ag.CSS_TRANSFORM_]="translate("+bd+"px,"+bc+"px)";this.scheduleUpdate()};ag.prototype.update_=function(){this.requestAnimationFrameId_=null;if(!this.isAdded_){return}if(this.isAnimated_){this.scheduleUpdate()}if(this.needsResize_&&this.resizeHandler_){this.needsResize_=false;this.resizeHandler_()}if(this.updateHandler_){this.updateHandler_()}};ag.prototype.getTopLeft=function(){return this.topLeft_};ag.prototype.scheduleUpdate=function(){if(this.isAdded_&&!this.requestAnimationFrameId_){this.requestAnimationFrameId_=this.requestAnimFrame_.call(av,this.requestUpdateFunction_)}}}var aG=function(bh){aK(a9,bh);function a9(bl,bo,bt){q(this,a9);var bp=a3(this,(a9.__proto__||Object.getPrototypeOf(a9)).call(this,bl,bo,bt));var bs=bp;var bn=null;bt=bt||{};bs.init(bt);bs.argCheck(bt);var br={map:bl,animate:false,updateHandler:function bm(){bs._canvasUpdate()},resolutionScale:resolutionScale};var bq=bp.canvasLayer=new ag(br);bp.clickEvent=bp.clickEvent.bind(bp);bp.mousemoveEvent=bp.mousemoveEvent.bind(bp);bp.bindEvent();return bp}a2(a9,[{key:"clickEvent",value:function bi(bm){var bl=bm.pixel;aJ(a9.prototype.__proto__||Object.getPrototypeOf(a9.prototype),"clickEvent",this).call(this,bl,bm)}},{key:"mousemoveEvent",value:function bg(bm){var bl=bm.pixel;aJ(a9.prototype.__proto__||Object.getPrototypeOf(a9.prototype),"mousemoveEvent",this).call(this,bl,bm)}},{key:"bindEvent",value:function bc(bm){var bl=this.map;if(this.options.methods){if(this.options.methods.click){bl.setDefaultCursor("default");bl.addListener("click",this.clickEvent)}if(this.options.methods.mousemove){bl.addListener("mousemove",this.mousemoveEvent)}}}},{key:"unbindEvent",value:function ba(bm){var bl=this.map;if(this.options.methods){if(this.options.methods.click){bl.removeListener("click",this.clickEvent)}if(this.options.methods.mousemove){bl.removeListener("mousemove",this.mousemoveEvent)}}}},{key:"getContext",value:function bf(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function bk(bq){if(!this.canvasLayer){return}var bz=this;var bs=bz.options.animation;var bn=this.getContext();if(bz.isEnabledTime()){if(bq===undefined){ap(bn);return}if(this.context=="2d"){bn.save();bn.globalCompositeOperation="destination-out";bn.fillStyle="rgba(0, 0, 0, .1)";bn.fillRect(0,0,bn.canvas.width,bn.canvas.height);bn.restore()}}else{ap(bn)}if(this.context=="2d"){for(var bx in bz.options){bn[bx]=bz.options[bx]}}else{bn.clear(bn.COLOR_BUFFER_BIT)}if(bz.options.minZoom&&bl.getZoom()<bz.options.minZoom||bz.options.maxZoom&&bl.getZoom()>bz.options.maxZoom){return}var br=1;if(this.context!="2d"){br=this.canvasLayer.devicePixelRatio}var bl=this.map;var bo=bl.getProjection();var br=Math.pow(2,bl.zoom)*resolutionScale;var bu=bo.fromLatLngToPoint(this.canvasLayer.getTopLeft());var by={transferCoordinate:function bw(bD){var bC=new google.maps.LatLng(bD[1],bD[0]);var bB=bo.fromLatLngToPoint(bC);var bA={x:(bB.x-bu.x)*br,y:(bB.y-bu.y)*br};return[bA.x,bA.y]}};if(bq!==undefined){by.filter=function(bB){var bA=bs.trails||10;if(bq&&bB.time>bq-bA&&bB.time<bq){return true}else{return false}}}var bv=bz.dataSet.get(by);this.processData(bv);var bp=new google.maps.LatLng(0,0);var bt=bo.fromLatLngToPoint(bp);var bm={x:(bt.x-bu.x)*br,y:(bt.y-bu.y)*br};if(bz.options.unit=="m"&&bz.options.size){bz.options._size=bz.options.size/zoomUnit}else{bz.options._size=bz.options.size}this.drawContext(bn,new i(bv),bz.options,bm);bz.options.updateCallback&&bz.options.updateCallback(bq)}},{key:"init",value:function bj(bm){var bl=this;bl.options=bm;this.initDataRange(bm);this.context=bl.options.context||"2d";if(bl.options.zIndex){this.canvasLayer&&this.canvasLayer.setZIndex(bl.options.zIndex)}this.initAnimator()}},{key:"addAnimatorEvent",value:function a8(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this));this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function be(){this.map.addOverlay(this.canvasLayer)}},{key:"hide",value:function bb(){this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function bd(){self.canvasLayer.draw()}}]);return a9}(aS);var n={getDataSet:function a5(a9){var ba=[];var a8=a9.features;for(var bb=0;bb<a8.length;bb++){var bg=a8[bb];var bd=bg.geometry;var bc=bg.properties;var bf={};for(var be in bc){bf[be]=bc[be]}bf.geometry=bd;ba.push(bf)}return new i(ba)}};var ai={CSVToArray:function aa(bc,be){be=be||",";var bd=new RegExp("(\\"+be+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+be+"\\r\\n]*))","gi");var a9=[[]];var bb=null;while(bb=bd.exec(bc)){var a8=bb[1];if(a8.length&&a8!==be){a9.push([])}var ba;if(bb[2]){ba=bb[2].replace(new RegExp('""',"g"),'"')}else{ba=bb[3]}a9[a9.length-1].push(ba)}return a9},getDataSet:function a5(a8){var bd=this.CSVToArray(a8,",");var ba=[];var bc=bd[0];for(var bb=1;bb<bd.length-1;bb++){var bg=bd[bb];var bf={};for(var a9=0;a9<bg.length;a9++){var be=bg[a9];if(bc[a9]=="geometry"){be=JSON.parse(be)}bf[bc[a9]]=be}ba.push(bf)}return new i(ba)}};V.version=C;V.canvasClear=ap;V.canvasResolutionScale=aC;V.canvasDrawSimple=aU;V.canvasDrawHeatmap=aE;V.canvasDrawGrid=aI;V.canvasDrawHoneycomb=an;V.webglDrawSimple=ad;V.webglDrawPoint=d;V.webglDrawLine=s;V.webglDrawPolygon=H;V.utilCityCenter=aR;V.utilCurve=r;V.utilForceEdgeBundling=w;V.utilDataRangeIntensity=p;V.utilDataRangeCategory=c;V.utilDataRangeChoropleth=m;V.Map=aW;V.baiduMapCanvasLayer=Y;V.baiduMapAnimationLayer=am;V.baiduMapLayer=Q;V.googleMapCanvasLayer=ag;V.googleMapLayer=aG;V.DataSet=i;V.geojson=n;V.csv=ai;Object.defineProperty(V,"__esModule",{value:true})})));